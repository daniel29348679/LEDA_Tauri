import{b as N}from"./quasar-ff3737c6.js";import"./base-23d00206.js";import{a as g}from"./el-button-ded9ecc1.js";import{E as C,a as W}from"./el-form-item-62aac1b2.js";/* empty css               */import{E as O,a as A}from"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import{E as G}from"./el-divider-67eeba91.js";import{E as D,a as H}from"./el-steps-c8cdef54.js";/* empty css                  */import{a as b}from"./el-main-e0dc383b.js";import{E as J}from"./el-alert-65b82b76.js";/* empty css                */import{u as X,i as V,f as p,o as Y}from"./index-d07dfee2.js";import{b as F}from"./earthApi-baaacd65.js";import{u as Z,_ as x}from"./app_aoi_od_cls-a5a35e1f.js";import{I as ee}from"./InferImg-e3b2bb14.js";import{y as oe,b as u,p as M,h as le,c as w,a as $,bf as _,ag as t,u as l,bI as a,a7 as c,a8 as R,S as I,o as s,b0 as q,af as y}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./index-b8931eed.js";import"./@vueuse-0d360189.js";import"./index-711061c4.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./async-validator-dee29e8b.js";import"./index-32075738.js";import"./event-9519ab40.js";import"./index-6127babd.js";import"./vnode-18f2a975.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./axios-439bb627.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";import"./el-popover-74fee5eb.js";import"./dropdown-c44bb395.js";import"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import"./typescript-defaf979.js";import"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import"./use-dialog-b8544ca4.js";import"./refs-e3a131a0.js";import"./el-image-viewer-1a9f012d.js";import"./el-table-column-5047dc3a.js";import"./el-checkbox-d46297b7.js";import"./normalize-wheel-es-ed76fb12.js";import"./el-tooltip-4ed993c7.js";import"./el-slider-07e60acd.js";import"./el-input-number-815f9c07.js";import"./el-input-51d05b2a.js";import"./@element-plus-a8abf029.js";import"./stashSpace-391fdb88.js";import"./StashSelect-5af938b3.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./ResultImgWithStash-c075e0f0.js";import"./el-card-a6aa41d5.js";const te={class:"step-page"},ae={class:"step-nav"},bo=oe({__name:"AppObjectDetectionClsAOI",setup(re){const B=X(),d=Z(),S=u(),m=u(1),n=u(!1),f=u([""]),v=u([""]),i=M({model_name_od:"",model_name_cls:""}),U=M({model_name_od:[{required:!0,message:V.global.t("NoModelName"),trigger:"blur"}],model_name_cls:[{required:!0,message:V.global.t("NoModelName"),trigger:"blur"}]}),z=async()=>{const e=await F.api.listdirsApiListdirsPost({model:"OD"});if(e===void 0||e.data.code===void 0){p("list od weights fail");return}const o=e.data;if(console.log("result =>",o),o.code!==0){p(`list od weights fail: ${o.code}`);return}f.value=o.result.folder_list,i.model_name_od=f.value.length>0?f.value[0]:""},K=async()=>{const e=await F.api.listdirsApiListdirsPost({model:"CLS"});if(e===void 0||e.data.code===void 0){p("list cls weights fail");return}const o=e.data;if(console.log("result =>",o),o.code!==0){p(`list cls weights fail: ${o.code}`);return}v.value=o.result.folder_list,i.model_name_cls=v.value.length>0?v.value[0]:""},P=async e=>{e&&await e.validate(async(o,r)=>{o?(console.log("submit!"),console.log(i),await j()):console.log("error submit!",r)})},j=async()=>{const e=Y();try{const o=await d.init(i.model_name_od,i.model_name_cls);if(o!==0){p(`od cls poc model init fail : ${o}`);return}m.value=1,n.value=!0}finally{e.close()}};le(async()=>{console.log("OD CLS AOI");let e=await d.checkInfo();if(e!==0){p(`check od cls aoi info fail : ${e}`);return}await z(),await K(),d.info.load?(i.model_name_od=d.info.model_name_od??"",i.model_name_cls=d.info.model_name_cls??"",m.value=1,n.value=!0):n.value=!1});const Q=()=>{i.model_name_od="",i.model_name_cls="",m.value=1,n.value=!1},T=()=>{n.value=!1},E=u(.7),k=u(),L=()=>{n.value&&(m.value=2,k.value&&k.value.closeResult())};return(e,o)=>(s(),w(I,null,[$("h4",null,_(e.$t("Dashboard.AOI_ODCLS")),1),t(l(G)),$("div",te,[$("div",ae,[t(l(H),{active:m.value,"finish-status":"success",class:"w3-margin-bottom",direction:l(B).lt.md?"horizontal":"vertical"},{default:a(()=>[t(l(D),{title:e.$t("ModelSet"),onClick:o[0]||(o[0]=r=>m.value=1),class:"pointer"},{icon:a(()=>[t(N,{name:"fa-solid fa-gear",class:"w3-large"})]),_:1},8,["title"]),t(l(D),{title:e.$t("Inference"),onClick:L,class:"pointer"},{icon:a(()=>[t(N,{name:"fa-solid fa-brain",class:"w3-large"})]),_:1},8,["title"])]),_:1},8,["active","direction"])]),m.value===1?(s(),c(l(b),{key:0},{default:a(()=>[!l(d).info.load&&f.value.length===0||!l(d).info.load&&v.value.length===0?(s(),c(l(b),{key:0,style:{height:"10vh"}},{default:a(()=>[t(l(J),{title:e.$t("NoWeight"),type:"warning",closable:!1,"show-icon":"",style:{"--el-alert-title-font-size":"1em"}},null,8,["title"])]),_:1})):(s(),c(l(b),{key:1},{default:a(()=>[t(l(W),{ref_key:"ruleFormRef",ref:S,model:i,rules:U,"label-position":"left",class:"demo-ruleForm","status-icon":""},{default:a(()=>[t(l(C),{label:e.$t("ModelName")+"-"+e.$t("Kernel.OD")},{default:a(()=>[t(l(O),{modelValue:i.model_name_od,"onUpdate:modelValue":o[1]||(o[1]=r=>i.model_name_od=r)},{default:a(()=>[(s(!0),w(I,null,q(f.value,(r,h)=>(s(),c(l(A),{label:r,value:r,key:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(l(C),{label:e.$t("ModelName")+"-"+e.$t("Kernel.CL")},{default:a(()=>[t(l(O),{modelValue:i.model_name_cls,"onUpdate:modelValue":o[2]||(o[2]=r=>i.model_name_cls=r)},{default:a(()=>[(s(!0),w(I,null,q(v.value,(r,h)=>(s(),c(l(A),{label:r,value:r,key:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(l(C),null,{default:a(()=>[t(l(g),{type:"primary",disabled:n.value,onClick:o[3]||(o[3]=r=>P(S.value))},{default:a(()=>[y(_(e.$t("ModelSet")),1)]),_:1},8,["disabled"]),t(l(g),{type:"danger",class:"q-ml-md",onClick:T},{default:a(()=>[y(_(e.$t("UnLock")),1)]),_:1}),t(l(g),{link:"",class:"q-ml-md",onClick:Q},{default:a(()=>[y(_(e.$t("Reset")),1)]),_:1}),t(l(g),{type:"primary",class:"q-mr-md",onClick:L,disabled:!n.value},{default:a(()=>[y(_(e.$t("Inference")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1}))]),_:1})):R("",!0),m.value===2?(s(),c(l(b),{key:1},{default:a(()=>[t(ee,{threshold:E.value,"onUpdate:threshold":o[4]||(o[4]=r=>E.value=r),ref_key:"InferImgRef",ref:k,infer_kernel:"od_cls",name:l(x)},null,8,["threshold","name"])]),_:1})):R("",!0)])],64))}});export{bo as default};

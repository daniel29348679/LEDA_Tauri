import{d as m}from"./pinia-71cafef5.js";import{b as a}from"./earthApi-baaacd65.js";import{b as n}from"./@vue-19632928.js";const s="defect-cls",i="ts_defect_cls",y=m("app-defect-cls",()=>{const o=n({load:!1,model_name:"",cam_name:""}),d=n(""),l=n(""),f=n(""),u=async e=>{const t=await a.api.initV8ClsApiInitClsPost({name:s,model_name:e});return t==null||t.data.code==null?-1:t.data.code!==0?t.data.code:await c()},c=async()=>{const e=await a.api.infoV8ClsApiInfoClsGet({name:s});if(console.log("res =>",e),e===void 0||e.data.code===void 0)return-1;if(e.data.code!==0)return e.data.code;if(o.value=e.data.result,e.data.result.doing&&e.data.result.result_image){let t=localStorage.getItem(i)??"";t===""&&(t=`${Date.now()}`,localStorage.setItem(i,t)),d.value=e.data.result.result_image+`&t=${t}`}return 0};return{info:o,imgURL:d,inferResult:l,detectResult:f,init:u,checkInfo:c,checkDetectInfo:async()=>{const e=await a.api.infoDefectClsApiInfoDefectClsGet({name:s});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(o.value={...o.value,bypass:e.data.result.bypass,pass_values:e.data.result.pass_values},0)},startInfer:async(e,t,p)=>{const r=await a.api.startDefectInferClsApiStartDefectInferClsPost({name:s,cam_name:e,pass_values:p,bypass:t});return console.log("res =>",r),r===void 0||r.data.code===void 0?-1:r.data.code!==0?r.data.code:await c()},stopInfer:async()=>{const e=await a.api.stopLiveInferV8ClsApiStopLiveInferClsPost({name:s});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(localStorage.removeItem(i),o.value.doing=!1,0)},getInferResult:async()=>{const e=await a.api.inferClsDefectResultApiInferClsDefectResultGet({name:s});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(l.value=e.data.result.last_result,f.value=e.data.result.detect_result,0)}}});export{y as u};

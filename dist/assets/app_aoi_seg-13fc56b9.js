import{d as w}from"./pinia-71cafef5.js";import{b as n}from"./earthApi-baaacd65.js";import{e as y}from"./index-d07dfee2.js";import{b as d}from"./@vue-19632928.js";const s="aoi-seg",l="ts_aoi_efs",P=w("app-aoi-seg",()=>{const i=d({load:!1,crop_m:1,crop_n:1}),f=d(""),u=d(),m=async a=>{const{model_name:e,cls_w_h_a:t,filter_type:o,alert_area:r,crop_m:g,crop_n:v,name:p,draw_alert_area:I,isFinal:S}=a,_=await n.api.initV8SegApiInitSegPost({model_name:e,cls_w_h_a:t,filter_type:o,alert_area:r,crop_m:g,crop_n:v,name:p??s,draw_alert_area:I});return _.data.code!==0?_.data.code:S?await c(p??s):0},c=async a=>{const e=a??s,t=await n.api.infoV8SegApiInfoSegGet({name:e});if(console.log("res =>",t),t===void 0||t.data.code===void 0)return-1;if(t.data.code!==0)return t.data.code;if(i.value=t.data.result,t.data.result.doing&&t.data.result.result_image){let o=localStorage.getItem(l)??"";o===""&&(o=`${Date.now()}`,localStorage.setItem(l,o)),f.value=t.data.result.result_image+`&t=${o}`}return 0};return{info:i,init:m,checkInfo:c,startInfer:async(a,e,t)=>{const o=t||s,r=await n.api.startLiveInferV8SegApiStartLiveInferSegPost({name:o,cam_name:a,threshold:e});return console.log("res =>",r),r===void 0||r.data.code===void 0?-1:r.data.code!==0?r.data.code:await c(o)},stopInfer:async a=>{const e=await y("json","/api/stop_live_infer_seg",{name:a});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(localStorage.removeItem(l),i.value.doing=!1,0)},imgURL:f,getInferResult:async a=>{const e=await n.api.inferV8SegLiveResultApiInferSegLiveResultGet({name:a});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(u.value=e.data.result.last_result,0)},inferResult:u}});export{s as _,P as u};

import{d as v}from"./pinia-71cafef5.js";import{b as o}from"./earthApi-baaacd65.js";import{e as u}from"./index-d07dfee2.js";import{b as i}from"./@vue-19632928.js";const r="poc-efs",d="ts_poc_efs",A=v("app-efs",()=>{const s=i({load:!1,alert_area:[]}),c=i(""),f=i(),p=async(e,a)=>{const t=await o.api.initEfsApiInitEfsPost({name:r,model_name:e,alert_area:a});return t==null||t.data.code==null?-1:t.data.code!==0?t.data.code:await n()},n=async()=>{const e=await o.api.infoEfsApiInfoEfsGet({name:r});if(console.log("res =>",e),e===void 0||e.data.code===void 0)return-1;if(e.data.code!==0)return e.data.code;if(s.value=e.data.result,e.data.result.doing&&e.data.result.result_image){let a=localStorage.getItem(d)??"";a===""&&(a=`${Date.now()}`,localStorage.setItem(d,a)),c.value=e.data.result.result_image+`&t=${a}`}return 0};return{info:s,imgURL:c,inferResult:f,init:p,checkInfo:n,startInfer:async(e,a)=>{const t=await o.api.startLiveInferEfsApiStartLiveInferEfsPost({name:r,cam_name:e,threshold:a});return console.log("res =>",t),t===void 0||t.data.code===void 0?-1:t.data.code!==0?t.data.code:await n()},stopInfer:async()=>{const e=await o.api.stopLiveInferEfsApiStopLiveInferEfsPost({name:r});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(localStorage.removeItem(d),s.value.doing=!1,0)},getInferResult:async()=>{const e=await o.api.inferEfsLiveResultApiInferEfsLiveResultGet({name:r});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(f.value=e.data.result.last_result,0)},initEfsModel:async(e,a)=>{try{const t=await u("json","/api/init_efs_model",{model:e,name:a});return console.log("res =>",t),t===void 0||t.data.code===void 0?-1:t.data.code!==0?t.data.code:""}catch(t){return console.log("err =>",t),-1}finally{console.log("finally")}},getEfsModel:async e=>{var t,l;const a=await u("json",`/api/info_efs_model?name=${e}`,{name:e},"GET");return console.log("res =>",a),a===void 0||a.data.code===void 0?"":a.data.code!==0?((l=(t=a.data)==null?void 0:t.result)==null?void 0:l.model)??"":""}}});export{A as u};

import"./base-23d00206.js";import{E as C,a as E}from"./el-row-67417f48.js";import{E as A}from"./el-card-a6aa41d5.js";import{E as L}from"./el-image-viewer-1a9f012d.js";import{E as k,a as D}from"./el-skeleton-item-b52dbad9.js";import{f as v,w as O}from"./index-d07dfee2.js";import{u as B}from"./app_ad-1c08fdc8.js";import{Q as d}from"./QuartCard-b656d875.js";import{L as F}from"./vue-chartjs-22160128.js";import{C as H,p as T,a as U,b as V,P as $,c as j,d as K,e as N}from"./chart.js-1176e628.js";import{y as P,b as m,h as Q,F as M,c as Z,ag as e,bI as l,u as o,S as q,o as z,a as G}from"./@vue-19632928.js";import{_ as J}from"./json-editor-vue3-5344cb8d.js";import"./lodash-es-cc4652a2.js";import"./typescript-defaf979.js";import"./index-b8931eed.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";import"./@kurkle-36ca2f10.js";import"./jsoneditor-5f1e2c9e.js";const u=30,W=P({__name:"AnomalyDetectionHome",setup(X){H.register(T,U,V,$,j,K,N);const f=["#f44336","#4CAF50"];let g=!1,n=[],i=[],r=[];const a=B(),p=m(""),h=m(0),_=m(""),y=m({labels:[],datasets:[]}),S=m({responsive:!0,animation:{duration:t=>t.dataIndex===u-1?600:0},animations:{},scales:{y:{beginAtZero:!0,stacked:!0}},interaction:{intersect:!1,mode:"index"}}),x=()=>{console.log("od result => ",r),console.log("objects => ",n),console.log("timeline => ",i);const t=i.map(c=>c.toLocaleTimeString()),s=n.map((c,b)=>({label:c,fill:!0,backgroundColor:f[b%f.length],borderColor:f[b%f.length],data:i.map((Y,I)=>r[I]===c?1:0)}));return{labels:t,datasets:s}},R=async()=>{try{let t=await a.checkInfo();if(t!==0){v(`check od poc info fail : ${t}`);return}if(a.info.load||O("請先至後台設定物件辨識應用"),a.info.doing){if(p.value=a.imgURL,t=await a.getInferResult(),t!==0){v(`get live inference result fail: ${t}`);return}a.inferResult&&(r.push(a.inferResult),r.length>u&&(r=r.slice(1,u+1)),n.push(a.inferResult),n=n.filter((s,c)=>n.indexOf(s)===c),i.push(new Date),i.length>u&&(i=i.slice(1,u+1)),h.value=n.length,_.value=a.inferResult,y.value=x())}}catch(t){v(`get live inference result fail: ${t}`)}},w=async()=>{g&&(await R(),setTimeout(()=>w(),1e3))};return Q(async()=>{console.log("物件辨識應用 mounted"),g=!0,await w()}),M(async()=>{console.log("物件辨識應用 unmounted"),g=!1}),(t,s)=>(z(),Z(q,null,[e(o(C),{gutter:16,class:"w3-margin-top"},{default:l(()=>[e(d,{type:"bool",title:"Status",value:_.value,color:_.value==="OK"?"green":"red"},null,8,["value","color"]),e(d,{title:"Specification",value:h.value,diff:"0.75%",color:"green",info:"since yesterday",icon:""},null,8,["value"]),e(d,{title:"Cameras Online",value:"1",diff:"OK",color:"green",info:"All systems are",suffix:""}),e(d,{title:"Vilolations",value:"8",diff:"2%",color:"red",info:"since last week",icon:""})]),_:1}),e(o(C),{gutter:16,class:"w3-margin-top"},{default:l(()=>[e(o(E),{span:10},{default:l(()=>[e(o(A),null,{default:l(()=>[s[0]||(s[0]=G("b",null,"Timeline Statistics",-1)),e(o(k),{rows:4,style:{height:"100%"},loading:!o(a).info.doing,throttle:500,animated:""},{default:l(()=>[e(o(F),{data:y.value,options:S.value},null,8,["data","options"])]),_:1},8,["loading"])]),_:1})]),_:1}),e(o(E),{span:14},{default:l(()=>[e(o(k),{style:{height:"100%"},loading:!o(a).info.doing||p.value==="",throttle:500,animated:""},{template:l(()=>[e(o(D),{variant:"image",style:{height:"100%"}})]),default:l(()=>[e(o(L),{src:p.value,"preview-src-list":[p.value]},null,8,["src","preview-src-list"])]),_:1},8,["loading"])]),_:1})]),_:1})],64))}});const De=J(W,[["__scopeId","data-v-8610b40d"]]);export{De as default};

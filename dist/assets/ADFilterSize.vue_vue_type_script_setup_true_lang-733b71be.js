import"./base-23d00206.js";/* empty css               */import{a as O,E as J}from"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import{a as K}from"./el-button-ded9ecc1.js";import{E as h}from"./el-form-item-62aac1b2.js";import"./el-input-51d05b2a.js";import{E as P}from"./el-input-number-815f9c07.js";import{I as Q,E as X,a as Y}from"./ImgDetectionPartition-4a04bf44.js";import{E as z}from"./el-switch-30a59a69.js";import{i as $}from"./index-d07dfee2.js";import{h as Z,a as A,j as x}from"./label-61e62ece.js";import{_ as c}from"./lodash-3dc9162a.js";import{y as ee,i as ae,b as I,c as _,ag as i,bI as u,u as t,a7 as p,a8 as d,S as V,o as r,af as y,bf as F,aN as le,b0 as C,a as T}from"./@vue-19632928.js";const te={key:4},oe={class:"ml-3"},re={key:1},Ve=ee({__name:"ADFilterSize",props:{initAD:{type:Function},model_name:{},formInfer:{},name:{},height:{},imgUrl:{},hideFilterSize:{type:Boolean},showDrawAlertArea:{type:Boolean}},emits:["update:formInfer"],setup(N,{expose:B,emit:L}){const m=N,G=L,e=ae({get:()=>m.formInfer,set:a=>G("update:formInfer",a)}),k=I([]),s=I("0"),w=[{w:0,h:0,a:0}],H=()=>{if(!e.value.w_h_a)return;const a=e.value.w_h_a.length.toString();e.value.w_h_a.push(c(w)),s.value=a},R=a=>{var f;if(!e.value.w_h_a||e.value.w_h_a.length===1)return;const l=e.value.w_h_a,n=a;l.splice(n,1),(f=e.value.alert_area)==null||f.splice(n,1),n==0&&(s.value="0"),s.value===l.length.toString()&&(s.value=(l.length-1).toString())},W=()=>{e.value.w_h_a=void 0,e.value.alert_area=void 0,e.value.filter_type=void 0},S=()=>{e.value.alert_area&&(k.value=[{name:"test",labels:e.value.alert_area.map((a,l)=>({...Z(a),label:`Part ${l+1}`}))}])},E=async a=>{e.value.isSizeFilter=a,a&&(console.log("props.model_name =>",m.model_name),e.value.w_h_a=[c(w)],m.model_name&&await D(m.model_name))},q=a=>{if(e.value.isPartitionFilter=a,!a){e.value.alert_area=[A],e.value.w_h_a=[[...w]],s.value="0";return}e.value.w_h_a&&(e.value.w_h_a=[c(e.value.w_h_a[0])]),s.value="0",e.value.alert_area=[A],S()},D=async(a,l=!0)=>{if(a===""){W();return}l&&(e.value.w_h_a=[c(w)],e.value.alert_area=[A],await m.initAD()),s.value="0"},M=async a=>{await a.forEach(l=>{var f;if(!e.value.alert_area)return;const n=(f=l.label.match(/\d+/))==null?void 0:f[0];n!=null&&(e.value.alert_area[+n-1]=x(l))}),S()},U=I();return B({onChangeModelName:D,onChangeSizeFilter:E,handlePartLabel:S,openImgDetectionPartition:()=>{var a;(a=U.value)==null||a.open()}}),(a,l)=>{const n=O,f=J;return r(),_(V,null,[i(t(h),{label:a.$t("FilterSize"),"label-width":"auto"},{default:u(()=>[i(t(z),{modelValue:e.value.isSizeFilter,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.isSizeFilter=o),onChange:l[1]||(l[1]=o=>E(o))},null,8,["modelValue"])]),_:1},8,["label"]),e.value.isSizeFilter&&m.showDrawAlertArea?(r(),p(t(h),{key:0,label:a.$t("DrawAlertArea"),"label-width":"auto"},{default:u(()=>[i(t(z),{modelValue:e.value.draw_alert_area,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.draw_alert_area=o)},null,8,["modelValue"])]),_:1},8,["label"])):d("",!0),e.value.isSizeFilter?(r(),p(t(h),{key:1,label:a.$t("FilterMethod"),"label-width":"auto"},{default:u(()=>[i(f,{modelValue:e.value.filter_type,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.filter_type=o)},{default:u(()=>[i(n,{label:a.$t("Area"),value:"area"},null,8,["label"]),i(n,{label:a.$t("W_H"),value:"w_h"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):d("",!0),e.value.isSizeFilter?(r(),p(t(h),{key:2,label:a.$t("FilterPartition"),"label-width":"auto"},{default:u(()=>[i(t(z),{modelValue:e.value.isPartitionFilter,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.isPartitionFilter=o),"active-text":t($).global.t("Partition"),"inactive-text":t($).global.t("Global"),onChange:l[5]||(l[5]=o=>q(o))},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])):d("",!0),e.value.isSizeFilter&&e.value.isPartitionFilter&&a.formInfer.w_h_a?(r(),p(Q,{key:"AD",ref_key:"imgDetectionPartitionRef",ref:U,"label-length":a.formInfer.w_h_a.length,"file-labels":k.value,"set-info":M,"img-url":m.imgUrl},{default:u(()=>[i(t(K),{type:"primary",class:le({"q-ml-sm":!m.imgUrl}),onClick:H},{default:u(()=>[y(F(a.$t("AddPartition")),1)]),_:1},8,["class"])]),_:1},8,["label-length","file-labels","img-url"])):d("",!0),e.value.isSizeFilter?(r(),_("div",te,[e.value.w_h_a?(r(),p(t(Y),{key:0,modelValue:s.value,"onUpdate:modelValue":l[6]||(l[6]=o=>s.value=o),class:"q-mb-sm",type:"border-card",closable:e.value.isPartitionFilter,onTabRemove:R,style:{"max-width":"100%"}},{default:u(()=>[(r(!0),_(V,null,C(a.formInfer.w_h_a,(o,g)=>(r(),p(t(X),{class:"setting-scroll scroll-bar",key:g.toString(),label:e.value.isPartitionFilter?a.$t("Partition")+(g+1):a.$t("Global"),name:g.toString()},{default:u(()=>[(r(!0),_(V,null,C(e.value.w_h_a[g],(v,j)=>(r(),p(t(h),{class:"border-form",key:j.toString(),"label-width":"auto"},{default:u(()=>[e.value.isSizeFilter&&e.value.filter_type==="w_h"?(r(),_(V,{key:0},[T("span",null,[y(F(a.$t("Width"))+"(px)： ",1),i(t(P),{modelValue:v.w,"onUpdate:modelValue":b=>v.w=b,min:0,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),T("span",oe,[y(F(a.$t("Height"))+"(px)： ",1),i(t(P),{modelValue:v.h,"onUpdate:modelValue":b=>v.h=b,min:0,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])],64)):d("",!0),e.value.isSizeFilter&&a.formInfer.filter_type==="area"?(r(),_("span",re,[y(F(a.$t("Area"))+"(px*px)： ",1),i(t(P),{modelValue:v.a,"onUpdate:modelValue":b=>v.a=b,min:0,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):d("",!0)]),_:2},1024))),128))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","closable"])):d("",!0)])):d("",!0)],64)}}});export{Ve as _};

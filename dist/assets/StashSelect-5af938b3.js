import{b as R}from"./quasar-ff3737c6.js";import{b as Ie,u as Le,_ as ve,w as Oe}from"./base-23d00206.js";/* empty css               */import{E as Ve,a as Fe}from"./el-select-99a9cb58.js";import{a as T}from"./el-scrollbar-e3b486eb.js";import{i as Pe,a as O,T as Ae,u as Re,b as ie}from"./el-button-ded9ecc1.js";import{E as De}from"./el-input-51d05b2a.js";import{E as ze,u as Ue,a as Ne,b as Ke}from"./el-overlay-81162264.js";import"./el-tooltip-4ed993c7.js";import{i as He}from"./@element-plus-a8abf029.js";import{i as qe}from"./index-d07dfee2.js";import{u as je}from"./stashSpace-391fdb88.js";import{E as x,B as re,k as Ge,f as ue}from"./index-b8931eed.js";import{y as G,i as E,o as f,c as w,a7 as g,bI as i,b4 as D,u as o,a8 as v,aN as m,b1 as j,n as z,b as I,p as Xe,m as de,d as Z,h as be,C as Je,bT as Y,bR as ee,x as Qe,b2 as L,B as J,ag as c,a as h,aP as ce,bM as H,bf as V,bK as q,af as Q,bC as W,T as We,aJ as he,a$ as ye,bP as fe,bO as Ze,S as Ye,b0 as _e}from"./@vue-19632928.js";import{o as pe,c as xe,E as en}from"./earthApi-baaacd65.js";import{i as nn}from"./validator-7d68535e.js";import{a as me}from"./index-711061c4.js";import{i as an}from"./@vueuse-0d360189.js";import{_ as on}from"./json-editor-vue3-5344cb8d.js";const tn=Ie({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Pe}}),sn={click:e=>e instanceof MouseEvent},ln=G({name:"ElLink"}),rn=G({...ln,props:tn,emits:sn,setup(e,{emit:t}){const n=e,s=Le("link"),u=E(()=>[s.b(),s.m(n.type),s.is("disabled",n.disabled),s.is("underline",n.underline&&!n.disabled)]);function r(l){n.disabled||t("click",l)}return(l,b)=>(f(),w("a",{class:m(o(u)),href:l.disabled||!l.href?void 0:l.href,target:l.disabled||!l.href?void 0:l.target,onClick:r},[l.icon?(f(),g(o(x),{key:0},{default:i(()=>[(f(),g(D(l.icon)))]),_:1})):v("v-if",!0),l.$slots.default?(f(),w("span",{key:1,class:m(o(s).e("inner"))},[j(l.$slots,"default")],2)):v("v-if",!0),l.$slots.icon?j(l.$slots,"icon",{key:2}):v("v-if",!0)],10,["href","target"]))}});var un=ve(rn,[["__file","link.vue"]]);const dn=Oe(un),_="_trap-focus-children",k=[],ge=e=>{if(k.length===0)return;const t=k[k.length-1][_];if(t.length>0&&e.code===xe.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const n=e.shiftKey,s=e.target===t[0],u=e.target===t[t.length-1];s&&n&&(e.preventDefault(),t[t.length-1].focus()),u&&!n&&(e.preventDefault(),t[0].focus())}},cn={beforeMount(e){e[_]=pe(e),k.push(e),k.length<=1&&document.addEventListener("keydown",ge)},updated(e){z(()=>{e[_]=pe(e)})},unmounted(){k.shift(),k.length===0&&document.removeEventListener("keydown",ge)}},fn=G({name:"ElMessageBox",directives:{TrapFocus:cn},components:{ElButton:O,ElFocusTrap:en,ElInput:De,ElOverlay:ze,ElIcon:x,...Ae},inheritAttrs:!1,props:{buttonSize:{type:String,validator:nn},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:n,zIndex:s,ns:u,size:r}=Re("message-box",E(()=>e.buttonSize)),{t:l}=n,{nextZIndex:b}=s,d=I(!1),a=Xe({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:de(re),cancelButtonLoadingIcon:de(re),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:b()}),y=E(()=>{const p=a.type;return{[u.bm("icon",p)]:p&&ie[p]}}),X=me(),C=me(),Ce=E(()=>a.icon||ie[a.type]||""),Se=E(()=>!!a.message),M=I(),ne=I(),P=I(),N=I(),ae=I(),Ee=E(()=>a.confirmButtonClass);Z(()=>a.inputValue,async p=>{await z(),e.boxType==="prompt"&&p!==null&&te()},{immediate:!0}),Z(()=>d.value,p=>{var S,$;p&&(e.boxType!=="prompt"&&(a.autofocus?P.value=($=(S=ae.value)==null?void 0:S.$el)!=null?$:M.value:P.value=M.value),a.zIndex=b()),e.boxType==="prompt"&&(p?z().then(()=>{var le;N.value&&N.value.$el&&(a.autofocus?P.value=(le=$e())!=null?le:M.value:P.value=M.value)}):(a.editorErrorMessage="",a.validateError=!1))});const Be=E(()=>e.draggable),ke=E(()=>e.overflow);Ue(M,ne,Be,ke),be(async()=>{await z(),e.closeOnHashChange&&window.addEventListener("hashchange",A)}),Je(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",A)});function A(){d.value&&(d.value=!1,z(()=>{a.action&&t("action",a.action)}))}const oe=()=>{e.closeOnClickModal&&K(a.distinguishCancelAndClose?"close":"cancel")},we=Ke(oe),Me=p=>{if(a.inputType!=="textarea")return p.preventDefault(),K("confirm")},K=p=>{var S;e.boxType==="prompt"&&p==="confirm"&&!te()||(a.action=p,a.beforeClose?(S=a.beforeClose)==null||S.call(a,p,a,A):A())},te=()=>{if(e.boxType==="prompt"){const p=a.inputPattern;if(p&&!p.test(a.inputValue||""))return a.editorErrorMessage=a.inputErrorMessage||l("el.messagebox.error"),a.validateError=!0,!1;const S=a.inputValidator;if(Y(S)){const $=S(a.inputValue);if($===!1)return a.editorErrorMessage=a.inputErrorMessage||l("el.messagebox.error"),a.validateError=!0,!1;if(ee($))return a.editorErrorMessage=$,a.validateError=!0,!1}}return a.editorErrorMessage="",a.validateError=!1,!0},$e=()=>{const p=N.value.$refs;return p.input||p.textarea},se=()=>{K("close")},Te=()=>{e.closeOnPressEscape&&se()};return e.lockScroll&&Ne(d),{...Qe(a),ns:u,overlayEvent:we,visible:d,hasMessage:Se,typeClass:y,contentId:X,inputId:C,btnSize:r,iconComponent:Ce,confirmButtonClasses:Ee,rootRef:M,focusStartRef:P,headerRef:ne,inputRef:N,confirmRef:ae,doClose:A,handleClose:se,onCloseRequested:Te,handleWrapperClick:oe,handleInputEnter:Me,handleAction:K,t:l}}});function pn(e,t,n,s,u,r){const l=L("el-icon"),b=L("close"),d=L("el-input"),a=L("el-button"),y=L("el-focus-trap"),X=L("el-overlay");return f(),g(We,{name:"fade-in-linear",onAfterLeave:C=>e.$emit("vanish"),persisted:""},{default:i(()=>[J(c(X,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:i(()=>[h("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:m(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[c(y,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:i(()=>[h("div",{ref:"rootRef",class:m([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:ce(e.customStyle),tabindex:"-1",onClick:H(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(f(),w("div",{key:0,ref:"headerRef",class:m([e.ns.e("header"),{"show-close":e.showClose}])},[h("div",{class:m(e.ns.e("title"))},[e.iconComponent&&e.center?(f(),g(l,{key:0,class:m([e.ns.e("status"),e.typeClass])},{default:i(()=>[(f(),g(D(e.iconComponent)))]),_:1},8,["class"])):v("v-if",!0),h("span",null,V(e.title),1)],2),e.showClose?(f(),w("button",{key:0,type:"button",class:m(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:C=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:q(H(C=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[c(l,{class:m(e.ns.e("close"))},{default:i(()=>[c(b)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):v("v-if",!0)],2)):v("v-if",!0),h("div",{id:e.contentId,class:m(e.ns.e("content"))},[h("div",{class:m(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(f(),g(l,{key:0,class:m([e.ns.e("status"),e.typeClass])},{default:i(()=>[(f(),g(D(e.iconComponent)))]),_:1},8,["class"])):v("v-if",!0),e.hasMessage?(f(),w("div",{key:1,class:m(e.ns.e("message"))},[j(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(f(),g(D(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(f(),g(D(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:i(()=>[Q(V(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):v("v-if",!0)],2),J(h("div",{class:m(e.ns.e("input"))},[c(d,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":C=>e.inputValue=C,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:m({invalid:e.validateError}),onKeydown:q(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),h("div",{class:m(e.ns.e("errormsg")),style:ce({visibility:e.editorErrorMessage?"visible":"hidden"})},V(e.editorErrorMessage),7)],2),[[W,e.showInput]])],10,["id"]),h("div",{class:m(e.ns.e("btns"))},[e.showCancelButton?(f(),g(a,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:m([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:C=>e.handleAction("cancel"),onKeydown:q(H(C=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:i(()=>[Q(V(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):v("v-if",!0),J(c(a,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:m([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:C=>e.handleAction("confirm"),onKeydown:q(H(C=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:i(()=>[Q(V(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[W,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[W,e.visible]])]),_:3},8,["onAfterLeave"])}var mn=ve(fn,[["render",pn],["__file","index.vue"]]);const U=new Map,gn=e=>{let t=document.body;return e.appendTo&&(ee(e.appendTo)&&(t=document.querySelector(e.appendTo)),ue(e.appendTo)&&(t=e.appendTo),ue(t)||(t=document.body)),t},vn=(e,t,n=null)=>{const s=c(mn,e,Y(e.message)||he(e.message)?{default:Y(e.message)?e.message:()=>e.message}:null);return s.appContext=n,ye(s,t),gn(e).appendChild(t.firstElementChild),s.component},bn=()=>document.createElement("div"),hn=(e,t)=>{const n=bn();e.onVanish=()=>{ye(null,n),U.delete(u)},e.onAction=r=>{const l=U.get(u);let b;e.showInput?b={value:u.inputValue,action:r}:b=r,e.callback?e.callback(b,s.proxy):r==="cancel"||r==="close"?e.distinguishCancelAndClose&&r!=="cancel"?l.reject("close"):l.reject("cancel"):l.resolve(b)};const s=vn(e,n,t),u=s.proxy;for(const r in e)fe(e,r)&&!fe(u.$props,r)&&(u[r]=e[r]);return u.visible=!0,u};function F(e,t=null){if(!an)return Promise.reject();let n;return ee(e)||he(e)?e={message:e}:n=e.callback,new Promise((s,u)=>{const r=hn(e,t??F._context);U.set(r,{options:e,callback:n,resolve:s,reject:u})})}const yn=["alert","confirm","prompt"],Cn={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};yn.forEach(e=>{F[e]=Sn(e)});function Sn(e){return(t,n,s,u)=>{let r="";return Ze(n)?(s=n,r=""):Ge(n)?r="":r=n,F(Object.assign({title:r,message:t,type:"",...Cn[e]},s,{boxType:e}),u)}}F.close=()=>{U.forEach((e,t)=>{t.doClose()}),U.clear()};F._context=null;const B=F;B.install=e=>{B._context=e._context,e.config.globalProperties.$msgbox=B,e.config.globalProperties.$messageBox=B,e.config.globalProperties.$alert=B.alert,e.config.globalProperties.$confirm=B.confirm,e.config.globalProperties.$prompt=B.prompt};const En=B;const Bn={class:"stash-select"},kn={class:"tooltip-text"},wn={class:"button-area"},Mn=G({__name:"StashSelect",props:{isOnPage:{type:Boolean,required:!1},isMoveData:{type:Boolean,required:!1},isUpload:{type:Boolean,required:!1},index:{type:Number,required:!1,default:1},getFirstFile:{type:Boolean,required:!1,default:!1}},emits:["onChanged","onViewed","onDestroyed"],setup(e,{emit:t}){const n=je(),s=e,u=t;be(()=>{n.fetchSpaceList(),s.isMoveData&&(n.isMoved=!1),n.currentFolderPath&&s.getFirstFile&&n.fetchSpaceFirstFile(n.currentSpace)}),Z(()=>n.currentSpace,(d,a)=>{u("onChanged",d,a),s.isUpload&&(n.currentUploadSpace=d)});const r=async()=>{n.drawerVisible?n.fetchSpaceFiles():n.openSpace(),u("onViewed")},l=()=>{En.confirm(qe.global.t("Button.Delete",{name:n.currentSpace})).then(async()=>{await n.fetchSpaceDestroy(),u("onDestroyed")})},b=d=>{s.getFirstFile&&n.fetchSpaceFirstFile(d[0])};return(d,a)=>(f(),w("div",Bn,[c(o(T),{placement:"top",disabled:!!o(n).stashList.length},{content:i(()=>[h("div",null,[c(o(x),{color:"#F56C6C"},{default:i(()=>[c(o(He))]),_:1}),h("span",kn,V(d.$t("Hint.PeaEntTmpStorSpcNameUpFile")),1)])]),default:i(()=>[c(o(Ve),{modelValue:o(n).spaceSelected,"onUpdate:modelValue":a[0]||(a[0]=y=>o(n).spaceSelected=y),multiple:"",filterable:"","allow-create":"","collapse-tags":"","multiple-limit":1,placeholder:d.$t("Hint.SelectStashSpace"),onChange:b},{default:i(()=>[(f(!0),w(Ye,null,_e(o(n).stashList,y=>(f(),g(o(Fe),{key:y.name,label:y.name,value:y.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["disabled"]),h("div",wn,[c(o(T),{content:d.$t("Button.View"),placement:"top"},{default:i(()=>[c(o(O),{type:"primary",onClick:r,disabled:!o(n).currentSpace||o(n).isNewSpace||o(n).loading},{default:i(()=>[c(R,{name:"fas fa-eye"})]),_:1},8,["disabled"])]),_:1},8,["content"]),c(o(T),{content:d.$t("Button.Delete"),placement:"top"},{default:i(()=>[s.isOnPage?v("",!0):(f(),g(o(O),{key:0,type:"danger",onClick:l,disabled:!o(n).currentSpace||o(n).loading},{default:i(()=>[c(R,{name:"fas fa-trash-alt"})]),_:1},8,["disabled"]))]),_:1},8,["content"]),c(o(T),{content:d.$t("Download"),placement:"top"},{default:i(()=>[s.isOnPage?v("",!0):(f(),g(o(dn),{key:0,href:`/api/stash/download?name=${o(n).currentSpace}`,disabled:!o(n).currentSpace||o(n).loading,underline:!1,download:""},{default:i(()=>[c(o(O),{disabled:!o(n).currentSpace||o(n).loading},{default:i(()=>[c(R,{name:"fas fa-download"})]),_:1},8,["disabled"])]),_:1},8,["href","disabled"]))]),_:1},8,["content"]),c(o(T),{content:d.$t("Button.UploadTo",{name:d.$t("StashSpace")}),placement:"top"},{default:i(()=>[s.isMoveData&&!o(n).isMoved&&s.isOnPage?(f(),g(o(O),{key:0,onClick:a[1]||(a[1]=y=>o(n).fetchMoveFiles()),disabled:!o(n).currentSpace||o(n).loading},{default:i(()=>[c(R,{name:"fas fa-upload"})]),_:1},8,["disabled"])):v("",!0)]),_:1},8,["content"]),c(o(T),{content:d.$t("Button.Open",{name:d.$t("Label.Folder")}),placement:"top"},{default:i(()=>[o(n).isLocal?(f(),g(o(O),{key:0,type:"info",onClick:a[2]||(a[2]=y=>o(n).fetchStashOpenFolderPost(o(n).currentSpace)),disabled:!o(n).currentSpace||o(n).loading},{default:i(()=>[c(R,{name:"fa-regular fa-folder-open"})]),_:1},8,["disabled"])):v("",!0)]),_:1},8,["content"]),j(d.$slots,"default",{},void 0,!0)])]))}});const Xn=on(Mn,[["__scopeId","data-v-314e2623"]]);export{dn as E,Xn as S,En as a};

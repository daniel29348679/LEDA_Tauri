import"./base-23d00206.js";import{E,a as G}from"./el-steps-c8cdef54.js";import{E as L}from"./el-divider-67eeba91.js";import{a as I}from"./el-button-ded9ecc1.js";import{c as q}from"./el-main-e0dc383b.js";import{E as O}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as H}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as T}from"./el-checkbox-d46297b7.js";import{d as D,o as J,p as K,h as P}from"./@element-plus-a8abf029.js";import{w,i as U,e as Q,u as X,o as Z,f as R}from"./index-d07dfee2.js";import{d as x}from"./pinia-71cafef5.js";import{b as f,y as ee,h as oe,c as h,a as u,bf as n,ag as a,u as e,bI as r,S as le,o as _,af as y,a7 as Y,a8 as F}from"./@vue-19632928.js";import{u as te}from"./stashSpace-391fdb88.js";import{S as W}from"./StashSelect-5af938b3.js";import{R as ae}from"./ResultImgWithStash-c075e0f0.js";import{E as B}from"./index-b8931eed.js";import"./lodash-es-cc4652a2.js";import"./event-9519ab40.js";import"./vnode-18f2a975.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./refs-e3a131a0.js";import"./index-6127babd.js";import"./quasar-ff3737c6.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import"./index-32075738.js";import"./el-input-51d05b2a.js";import"./el-tooltip-4ed993c7.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-image-viewer-1a9f012d.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const se=x("uploadFileYOLO",()=>{const $=f();return{upload:async(g,p,d,c,i=void 0)=>{if($.value=void 0,(i==null?void 0:i.image_folder_path)===""&&p.length===0||(i==null?void 0:i.label_folder_path)===""&&d.length===0)return w(U.global.t("NoFile")),!1;const v=new FormData;for(const o of p){const m=await o.raw.arrayBuffer();v.append("image",new Blob([m]),o.name)}for(const o of d){const m=await o.raw.arrayBuffer();v.append("label_file",new Blob([m]),o.name)}for(const o of c){const m=await o.raw.arrayBuffer();v.append("class_name",new Blob([m]),o.name)}if(i)for(const o of Object.keys(i))v.append(o,`${i[o]}`);const S=await Q("form",g,v);if(S==null)return!1;const b=await S.data;return $.value=b,!0},uploadResult:$}}),ie={class:"step-page"},re={class:"step-nav"},ne={key:0},ue={key:0},pe={class:"el-upload__tip"},de={class:"el-upload__tip"},me=["src"],fe={key:1},ce={class:"el-upload__text"},ve={class:"el-upload__tip"},_e={key:0},ge={class:"el-upload__tip"},he={class:"el-upload__text"},ye={class:"el-upload__tip"},Se={key:2},bo=ee({__name:"YOLOToVOCView",setup($){const N=X(),g=te();oe(()=>{console.log("YOLOToVOC"),g.spaceSelected=[]});const p=f(1),d=f([]),c=f([]),i=f([]),v=se(),S=f(""),b=f(!1),o=f(!1),m=f(""),k=f(""),M=()=>{if(o.value&&(m.value=g.currentFolderPath,g.spaceSelected=[]),o.value&&m.value==="")return w(U.global.t("NoFile")),!1;if(!o.value&&d.value.length===0)return w(U.global.t("NoFile")),!1;p.value++},j=async()=>{o.value&&(k.value=g.currentFolderPath,g.spaceSelected=[]);const t=o.value&&k.value===""||!o.value&&c.value.length===0,l=i.value.length===0;if(t||l)return w(U.global.t("NoFile")),!1;const s=Z();try{const V={image_folder_path:m.value,label_folder_path:k.value};await v.upload("/api/yolo_to_voc",d.value,c.value,i.value,V);const C=v.uploadResult;if(!C)return;if(C.code!==0){R(`API Error: ${C.code}`);return}p.value++}catch(V){R(`${V}`)}finally{s.close()}},z=(t,l)=>{console.log(t,l)},A=t=>{S.value=t.url,b.value=!0};return(t,l)=>(_(),h(le,null,[u("h4",null,n(t.$t("TransferFile",{fs:"YOLO",fe:"VOC"})),1),a(e(L)),u("div",ie,[u("div",re,[a(e(G),{active:p.value,"finish-status":"success",class:"w3-margin-bottom",direction:e(N).lt.md?"horizontal":"vertical"},{default:r(()=>[a(e(E),{title:t.$t("UploadImage"),icon:e(D),onClick:l[0]||(l[0]=s=>(p.value=1,d.value=[],c.value=[],i.value=[])),class:"pointer"},null,8,["title","icon"]),a(e(E),{title:t.$t("UploadLabel"),icon:e(D),onClick:l[1]||(l[1]=s=>(p.value=d.value.length>0?2:1,c.value=[],i.value=[])),class:"pointer"},null,8,["title","icon"]),a(e(E),{title:t.$t("Generate"),icon:e(J)},null,8,["title","icon"])]),_:1},8,["active","direction"])]),a(e(q),null,{default:r(()=>[p.value===1?(_(),h("div",ne,[a(e(I),{type:"success",onClick:l[2]||(l[2]=s=>M())},{default:r(()=>[y(n(t.$t("Upload")),1)]),_:1}),a(e(L)),a(e(T),{modelValue:o.value,"onUpdate:modelValue":l[3]||(l[3]=s=>o.value=s)},{default:r(()=>[y(n(t.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),o.value?(_(),h("div",ue,[a(W,{"is-on-page":"","is-upload":""}),u("span",pe,n(t.$t("UploadImg")),1)])):(_(),Y(e(O),{key:1,class:"upload-drag-img","file-list":d.value,"onUpdate:fileList":l[4]||(l[4]=s=>d.value=s),action:"/api/yolo_to_voc","list-type":"picture-card","auto-upload":!1,"on-preview":A,"on-remove":z,multiple:"",drag:""},{tip:r(()=>[u("div",de,n(t.$t("UploadImg")),1)]),default:r(()=>[a(e(B),null,{default:r(()=>[a(e(K))]),_:1})]),_:1},8,["file-list"])),a(e(H),{modelValue:b.value,"onUpdate:modelValue":l[5]||(l[5]=s=>b.value=s)},{default:r(()=>[u("img",{style:{width:"100%"},src:S.value,alt:"Preview Image"},null,8,me)]),_:1},8,["modelValue"])])):F("",!0),p.value===2&&(d.value.length!==0||m.value!=="")?(_(),h("div",fe,[a(e(I),{type:"success",onClick:l[6]||(l[6]=s=>j())},{default:r(()=>[y(n(t.$t("Upload")),1)]),_:1}),a(e(L)),a(e(O),{"file-list":i.value,"onUpdate:fileList":l[7]||(l[7]=s=>i.value=s),class:"upload-demo",action:"/api/yolo_to_voc","auto-upload":!1,drag:""},{tip:r(()=>[u("div",ve,n(t.$t("UploadClassName")),1)]),default:r(()=>[a(e(B),{class:"el-icon--upload"},{default:r(()=>[a(e(P))]),_:1}),u("div",ce,[y(n(t.$t("DropFile"))+" ",1),u("em",null,n(t.$t("ClickToUpload")),1)])]),_:1},8,["file-list"]),a(e(T),{modelValue:o.value,"onUpdate:modelValue":l[8]||(l[8]=s=>o.value=s)},{default:r(()=>[y(n(t.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),o.value?(_(),h("div",_e,[a(W,{"is-on-page":"","is-upload":""}),u("span",ge,n(t.$t("UploadClassName")),1)])):(_(),Y(e(O),{key:1,"file-list":c.value,"onUpdate:fileList":l[9]||(l[9]=s=>c.value=s),class:"upload-demo",action:"/api/yolo_to_voc","auto-upload":!1,multiple:"",drag:""},{tip:r(()=>[u("div",ye,n(t.$t("UploadLabel")),1)]),default:r(()=>[a(e(B),{class:"el-icon--upload"},{default:r(()=>[a(e(P))]),_:1}),u("div",he,[y(n(t.$t("DropFile"))+" ",1),u("em",null,n(t.$t("ClickToUpload")),1)])]),_:1},8,["file-list"]))])):F("",!0),p.value===3?(_(),h("div",Se,[a(ae)])):F("",!0)]),_:1})])],64))}});export{bo as default};

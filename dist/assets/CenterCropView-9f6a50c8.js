import"./base-23d00206.js";import{E as z}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as A}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as y,a as M}from"./el-steps-c8cdef54.js";import{E as $}from"./el-divider-67eeba91.js";import{a as b}from"./el-button-ded9ecc1.js";import{c as T}from"./el-main-e0dc383b.js";import{E as x}from"./el-image-viewer-1a9f012d.js";import"./el-input-51d05b2a.js";import{E as U}from"./el-input-number-815f9c07.js";/* empty css                */import{a as G,E as I}from"./el-form-item-62aac1b2.js";import{E as W}from"./el-checkbox-d46297b7.js";import{d as X,g as Y,o as j,p as q}from"./@element-plus-a8abf029.js";import{u as H,o as N,f as S}from"./index-d07dfee2.js";import{u as J}from"./uploadFile-6ce60004.js";import{u as K}from"./stashSpace-391fdb88.js";import{S as O}from"./StashSelect-5af938b3.js";import{R as Q}from"./ResultImgWithStash-c075e0f0.js";import{E as Z}from"./index-b8931eed.js";import{y as ee,h as te,b as s,c as f,a as n,bf as p,ag as l,u as t,bI as r,S as le,o as m,af as V,a8 as g,aN as oe,a7 as ae}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./event-9519ab40.js";import"./refs-e3a131a0.js";import"./vnode-18f2a975.js";import"./@ctrl-f8748455.js";import"./index-6127babd.js";import"./index-32075738.js";import"./async-validator-dee29e8b.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import"./el-tooltip-4ed993c7.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const re={class:"step-page"},ie={class:"step-nav"},se={key:0},ne={class:"el-upload__tip"},ue={class:"el-upload__tip text-red"},pe=["src"],me={key:1},de={style:{display:"flex","flex-direction":"column"}},ve={key:0},ce={class:"el-upload__tip"},fe={key:2},wt=ee({__name:"CenterCropView",setup(ge){const P=H(),F=K();te(()=>{console.log("CenterCrop")});const i=s(1),_=J(),k=s(""),w=s(!1),d=s([]),u=s([]),v=s([]),h=s(640),E=s(640),c=s(!1),B=(o,e)=>{console.log(o,e)},R=o=>{k.value=o.url,w.value=!0},D=async()=>{await C()&&i.value++},C=async()=>{const o=N();try{await _.upload("/api/center_crop",[d.value[0]],{new_width:h.value,new_height:E.value});const e=_.uploadResult;if(!e)return;if(e.code!==0){S(`API Error: ${e.code}`);return}return u.value=e.result.all_names,!0}catch(e){S(`${e}`)}finally{o.close()}},L=async()=>{const o=N();try{const e={new_width:h.value,new_height:E.value};c.value&&(e.folder_path=F.currentFolderPath),await _.upload("/api/center_crop",d.value,e);const a=_.uploadResult;if(!a)return;if(a.code!==0){S(`API Error: ${a.code}`);return}v.value=a.result.all_names,i.value++}catch(e){S(`${e}`)}finally{o.close()}};return(o,e)=>(m(),f(le,null,[n("h4",null,p(o.$t("CenterCrop")),1),l(t($)),n("div",re,[n("div",ie,[l(t(M),{active:i.value,"finish-status":"success",class:"w3-margin-bottom",direction:t(P).lt.md?"horizontal":"vertical"},{default:r(()=>[l(t(y),{title:o.$t("Upload"),icon:t(X),onClick:e[0]||(e[0]=a=>(i.value=1,d.value=[],u.value=[],v.value=[])),class:"pointer"},null,8,["title","icon"]),l(t(y),{title:o.$t("Setting"),icon:t(Y),onClick:e[1]||(e[1]=a=>i.value=u.value.length>0?2:1),class:"pointer"},null,8,["title","icon"]),l(t(y),{title:o.$t("Generate"),icon:t(j),onClick:e[2]||(e[2]=a=>i.value=v.value.length>0?3:2),class:"pointer"},null,8,["title","icon"])]),_:1},8,["active","direction"])]),l(t(T),null,{default:r(()=>[i.value===1?(m(),f("div",se,[l(t(b),{type:"success",onClick:e[3]||(e[3]=a=>D())},{default:r(()=>[V(p(o.$t("Upload")),1)]),_:1}),l(t($)),l(t(z),{class:"upload-drag-img","file-list":d.value,"onUpdate:fileList":e[4]||(e[4]=a=>d.value=a),action:"/api/center_crop","list-type":"picture-card","auto-upload":!1,"on-preview":R,"on-remove":B,multiple:"",drag:""},{tip:r(()=>[n("div",ne,p(o.$t("UploadImg")),1),n("div",ue,p(o.$t("StashSpaceUploadImageConfigureFirst")),1)]),default:r(()=>[l(t(Z),null,{default:r(()=>[l(t(q))]),_:1})]),_:1},8,["file-list"]),l(t(A),{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=a=>w.value=a)},{default:r(()=>[n("img",{style:{width:"100%"},src:k.value,alt:"Preview Image"},null,8,pe)]),_:1},8,["modelValue"])])):g("",!0),i.value===2&&u.value.length!==0?(m(),f("div",me,[l(t(W),{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=a=>c.value=a)},{default:r(()=>[V(p(o.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),n("div",de,[c.value?(m(),f("div",ve,[l(O,{"is-on-page":"","is-upload":""}),n("span",ce,p(o.$t("UploadImg")),1)])):g("",!0),l(t(b),{class:oe({"ml-3":c.value}),type:"success",onClick:e[7]||(e[7]=a=>L())},{default:r(()=>[V(p(o.$t("Setting")),1)]),_:1},8,["class"])]),l(t($)),l(t(G),{"label-width":"150px","label-position":"left"},{default:r(()=>[l(t(I),{label:o.$t("CenterCropX")},{default:r(()=>[l(t(U),{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=a=>h.value=a),min:10,onChange:e[9]||(e[9]=a=>C())},null,8,["modelValue"])]),_:1},8,["label"]),l(t(I),{label:o.$t("CenterCropY")},{default:r(()=>[l(t(U),{modelValue:E.value,"onUpdate:modelValue":e[10]||(e[10]=a=>E.value=a),min:10,onChange:e[11]||(e[11]=a=>C())},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),u.value.length!==0?(m(),ae(t(x),{key:0,style:{margin:"10px"},src:u.value[0],"preview-src-list":u.value,fit:"scale-down"},null,8,["src","preview-src-list"])):g("",!0)])):g("",!0),i.value===3&&v.value.length!==0?(m(),f("div",fe,[l(Q,{all_names:v.value},null,8,["all_names"])])):g("",!0)]),_:1})])],64))}});export{wt as default};

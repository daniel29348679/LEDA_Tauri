import"./base-23d00206.js";import{E as ue}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as ne}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as K,a as ie}from"./el-steps-c8cdef54.js";import{E as O}from"./el-divider-67eeba91.js";import{a as Y}from"./el-button-ded9ecc1.js";import{c as pe}from"./el-main-e0dc383b.js";import{E as b}from"./el-image-viewer-1a9f012d.js";/* empty css                */import{a as ve,E as V}from"./el-form-item-62aac1b2.js";import{E as T}from"./el-slider-07e60acd.js";import"./el-input-51d05b2a.js";import{E as G}from"./el-input-number-815f9c07.js";import"./el-tooltip-4ed993c7.js";import"./el-scrollbar-e3b486eb.js";import{E as z}from"./el-checkbox-d46297b7.js";import{d as de,g as me,o as ce,p as ge}from"./@element-plus-a8abf029.js";import{u as fe,o as Z,f as m}from"./index-d07dfee2.js";import{u as he}from"./uploadFile-6ce60004.js";import{u as we}from"./stashSpace-391fdb88.js";import{S as _e}from"./StashSelect-5af938b3.js";import{R as be}from"./ResultImgWithStash-c075e0f0.js";import{E as Ve}from"./index-b8931eed.js";import{y as ye,h as $e,b as o,c as w,a as d,bf as $,ag as s,u as a,bI as n,S as Ee,o as i,af as Q,a8 as p,aN as Se,a7 as y}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./event-9519ab40.js";import"./refs-e3a131a0.js";import"./vnode-18f2a975.js";import"./@ctrl-f8748455.js";import"./async-validator-dee29e8b.js";import"./index-6127babd.js";import"./index-32075738.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const ke={class:"step-page"},Ce={class:"step-nav"},Ue={key:0},Ie={class:"el-upload__tip"},xe={class:"el-upload__tip text-red"},Re=["src"],Pe={key:1},Ae={style:{display:"flex","flex-direction":"column"}},Ne={key:0},Be={class:"el-upload__tip"},Fe={key:0},De={key:1},Le={key:2},ze={key:3},Me={key:2},Jl=ye({__name:"ImgEnhView",setup(Te){const ee=fe(),le=we();$e(()=>{console.log("ImgEnh")});const _=o(1),u=he(),X=o(""),W=o(!1),v=o([]),U=o([]),I=o(!1),c=o([1,1]),g=o([1,1]),f=o([1,1]),h=o([1,1]),j=o(.2),q=o(.2),H=o(.2),J=o(.2),E=o(!1),S=o(!1),k=o(!1),C=o(!1),x=o([]),R=o([]),P=o([]),A=o([]),N=o([]),B=o([]),F=o([]),D=o([]),ae=(t,e)=>{console.log(t,e)},te=t=>{X.value=t.url,W.value=!0},se=()=>{_.value++},oe=async t=>{t==="brightness"&&(E.value===!1?c.value=[1,1]:c.value=[.8,1.2]),t==="contrast"&&(S.value===!1?g.value=[1,1]:g.value=[.8,1.2]),t==="sharpness"&&(k.value===!1?f.value=[1,1]:f.value=[.8,1.2]),t==="color"&&(C.value===!1?h.value=[1,1]:h.value=[.8,1.2])},M=async t=>{await oe(t),await L(t)},L=async t=>{const e=Z();if(t==="brightness"){await u.upload("/api/enhance_img",[v.value[0]],{brightness:c.value[0],contrast:1,sharpness:1,color:1});const l=u.uploadResult;if(l){if(l.code!==0){m(`API Error: ${l.code}`);return}x.value=l.result.all_names}await u.upload("/api/enhance_img",[v.value[0]],{brightness:c.value[1],contrast:1,sharpness:1,color:1});const r=u.uploadResult;if(r){if(r.code!==0){m("API Error : "+r.code);return}R.value=r.result.all_names}}if(t==="contrast"){await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:g.value[0],sharpness:1,color:1});const l=u.uploadResult;if(l){if(l.code!==0){m(`API Error: ${l.code}`);return}P.value=l.result.all_names}await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:g.value[1],sharpness:1,color:1});const r=u.uploadResult;if(r){if(r.code!==0){m("API Error : "+r.code);return}A.value=r.result.all_names}}if(t==="sharpness"){await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:1,sharpness:f.value[0],color:1});const l=u.uploadResult;if(l){if(l.code!==0){m(`API Error: ${l.code}`);return}N.value=l.result.all_names}await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:1,sharpness:f.value[1],color:1});const r=u.uploadResult;if(r){if(r.code!==0){m("API Error : "+r.code);return}B.value=r.result.all_names}}if(t==="color"){await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:1,sharpness:1,color:h.value[0]});const l=u.uploadResult;if(l){if(l.code!==0){m(`API Error: ${l.code}`);return}F.value=l.result.all_names}await u.upload("/api/enhance_img",[v.value[0]],{brightness:1,contrast:1,sharpness:1,color:h.value[1]});const r=u.uploadResult;if(r){if(r.code!==0){m("API Error : "+r.code);return}D.value=r.result.all_names}}e.close()},re=async()=>{const t=Z();try{const e={brightness_lower:c.value[0],brightness_upper:c.value[1],brightness_step:j.value,contrast_lower:g.value[0],contrast_upper:g.value[1],contrast_step:q.value,sharpness_lower:f.value[0],sharpness_upper:f.value[1],sharpness_step:H.value,color_lower:h.value[0],color_upper:h.value[1],color_step:J.value};I.value&&(e.folder_path=le.currentFolderPath),await u.upload("/api/step_enhance_img",v.value,e);const l=u.uploadResult;if(!l)return;if(l.code!==0){m(`API Error: ${l.code}`);return}U.value=l.result.all_names,_.value++}catch(e){m(`${e}`)}finally{t.close()}};return(t,e)=>(i(),w(Ee,null,[d("h4",null,$(t.$t("ImgEnh")),1),s(a(O)),d("div",ke,[d("div",Ce,[s(a(ie),{active:_.value,"finish-status":"success",class:"w3-margin-bottom",direction:a(ee).lt.md?"horizontal":"vertical"},{default:n(()=>[s(a(K),{title:t.$t("Upload"),icon:a(de),onClick:e[0]||(e[0]=l=>(_.value=1,v.value=[],E.value=!1,S.value=!1,k.value=!1,C.value=!1,x.value=[],R.value=[],P.value=[],A.value=[],N.value=[],B.value=[],F.value=[],D.value=[],U.value=[])),class:"pointer"},null,8,["title","icon"]),s(a(K),{title:t.$t("Setting"),icon:a(me),onClick:e[1]||(e[1]=l=>(_.value=v.value.length>0?2:1,E.value=!1,S.value=!1,k.value=!1,C.value=!1,c.value=[1,1],g.value=[1,1],f.value=[1,1],h.value=[1,1],U.value=[])),class:"pointer"},null,8,["title","icon"]),s(a(K),{title:t.$t("Generate"),icon:a(ce)},null,8,["title","icon"])]),_:1},8,["active","direction"])]),s(a(pe),null,{default:n(()=>[_.value===1?(i(),w("div",Ue,[s(a(Y),{type:"success",onClick:e[2]||(e[2]=l=>se())},{default:n(()=>[Q($(t.$t("Upload")),1)]),_:1}),s(a(O)),s(a(ue),{class:"upload-drag-img","file-list":v.value,"onUpdate:fileList":e[3]||(e[3]=l=>v.value=l),action:"/api/percentage_crop","list-type":"picture-card","auto-upload":!1,"on-preview":te,"on-remove":ae,accept:"image/*",multiple:"",drag:""},{tip:n(()=>[d("div",Ie,$(t.$t("UploadImg")),1),d("div",xe,$(t.$t("StashSpaceUploadImageConfigureFirst")),1)]),default:n(()=>[s(a(Ve),null,{default:n(()=>[s(a(ge))]),_:1})]),_:1},8,["file-list"]),s(a(ne),{modelValue:W.value,"onUpdate:modelValue":e[4]||(e[4]=l=>W.value=l)},{default:n(()=>[d("img",{style:{width:"100%"},src:X.value,alt:"Preview Image"},null,8,Re)]),_:1},8,["modelValue"])])):p("",!0),_.value===2&&v.value.length!==0?(i(),w("div",Pe,[s(a(z),{modelValue:I.value,"onUpdate:modelValue":e[5]||(e[5]=l=>I.value=l)},{default:n(()=>[Q($(t.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),d("div",Ae,[I.value?(i(),w("div",Ne,[s(_e,{"is-on-page":"","is-upload":""}),d("span",Be,$(t.$t("UploadImg")),1)])):p("",!0),s(a(Y),{class:Se({"ml-3":I.value}),type:"success",onClick:e[6]||(e[6]=l=>re())},{default:n(()=>[Q($(t.$t("Setting")),1)]),_:1},8,["class"])]),s(a(O)),s(a(ve),{"label-width":"170px","label-position":"left"},{default:n(()=>[s(a(z),{modelValue:E.value,"onUpdate:modelValue":e[7]||(e[7]=l=>E.value=l),label:t.$t("Brightness"),onChange:e[8]||(e[8]=l=>M("brightness"))},null,8,["modelValue","label"]),E.value===!0?(i(),w("div",Fe,[s(a(V),{label:t.$t("BrightnessRange")},{default:n(()=>[s(a(T),{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=l=>c.value=l),range:"",min:.5,max:1.5,step:.001,onChange:e[10]||(e[10]=l=>L("brightness"))},null,8,["modelValue"])]),_:1},8,["label"]),s(a(V),{label:t.$t("Step")},{default:n(()=>[s(a(G),{modelValue:j.value,"onUpdate:modelValue":e[11]||(e[11]=l=>j.value=l),precision:2,step:.01,min:.01},null,8,["modelValue"])]),_:1},8,["label"]),x.value.length!==0?(i(),y(a(b),{key:0,style:{width:"500px",height:"500px",margin:"10px"},src:x.value[0],"preview-src-list":x.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0),R.value.length!==0?(i(),y(a(b),{key:1,style:{width:"500px",height:"500px",margin:"10px"},src:R.value[0],"preview-src-list":R.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0)])):p("",!0),e[27]||(e[27]=d("br",null,null,-1)),s(a(z),{modelValue:S.value,"onUpdate:modelValue":e[12]||(e[12]=l=>S.value=l),label:t.$t("Contrast"),onChange:e[13]||(e[13]=l=>M("contrast"))},null,8,["modelValue","label"]),S.value===!0?(i(),w("div",De,[s(a(V),{label:t.$t("ContrastRange")},{default:n(()=>[s(a(T),{modelValue:g.value,"onUpdate:modelValue":e[14]||(e[14]=l=>g.value=l),range:"",min:.5,max:1.5,step:.001,onChange:e[15]||(e[15]=l=>L("contrast"))},null,8,["modelValue"])]),_:1},8,["label"]),s(a(V),{label:t.$t("Step")},{default:n(()=>[s(a(G),{modelValue:q.value,"onUpdate:modelValue":e[16]||(e[16]=l=>q.value=l),precision:2,step:.01,min:.01},null,8,["modelValue"])]),_:1},8,["label"]),P.value.length!==0?(i(),y(a(b),{key:0,style:{width:"500px",height:"500px",margin:"10px"},src:P.value[0],"preview-src-list":P.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0),A.value.length!==0?(i(),y(a(b),{key:1,style:{width:"500px",height:"500px",margin:"10px"},src:A.value[0],"preview-src-list":A.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0)])):p("",!0),e[28]||(e[28]=d("br",null,null,-1)),s(a(z),{modelValue:k.value,"onUpdate:modelValue":e[17]||(e[17]=l=>k.value=l),label:t.$t("Sharpness"),onChange:e[18]||(e[18]=l=>M("sharpness"))},null,8,["modelValue","label"]),k.value===!0?(i(),w("div",Le,[s(a(V),{label:t.$t("SharpnessRange")},{default:n(()=>[s(a(T),{modelValue:f.value,"onUpdate:modelValue":e[19]||(e[19]=l=>f.value=l),range:"",min:.5,max:1.5,step:.001,onChange:e[20]||(e[20]=l=>L("sharpness"))},null,8,["modelValue"])]),_:1},8,["label"]),s(a(V),{label:t.$t("Step")},{default:n(()=>[s(a(G),{modelValue:H.value,"onUpdate:modelValue":e[21]||(e[21]=l=>H.value=l),precision:2,step:.01,min:.01},null,8,["modelValue"])]),_:1},8,["label"]),N.value.length!==0?(i(),y(a(b),{key:0,style:{width:"500px",height:"500px",margin:"10px"},src:N.value[0],"preview-src-list":N.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0),B.value.length!==0?(i(),y(a(b),{key:1,style:{width:"500px",height:"500px",margin:"10px"},src:B.value[0],"preview-src-list":B.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0)])):p("",!0),e[29]||(e[29]=d("br",null,null,-1)),s(a(z),{modelValue:C.value,"onUpdate:modelValue":e[22]||(e[22]=l=>C.value=l),label:t.$t("Color"),onChange:e[23]||(e[23]=l=>M("color"))},null,8,["modelValue","label"]),C.value===!0?(i(),w("div",ze,[s(a(V),{label:t.$t("ColorRange")},{default:n(()=>[s(a(T),{modelValue:h.value,"onUpdate:modelValue":e[24]||(e[24]=l=>h.value=l),range:"",min:.5,max:1.5,step:.001,onChange:e[25]||(e[25]=l=>L("color"))},null,8,["modelValue"])]),_:1},8,["label"]),s(a(V),{label:t.$t("Step")},{default:n(()=>[s(a(G),{modelValue:J.value,"onUpdate:modelValue":e[26]||(e[26]=l=>J.value=l),precision:2,step:.01,min:.01},null,8,["modelValue"])]),_:1},8,["label"]),F.value.length!==0?(i(),y(a(b),{key:0,style:{width:"500px",height:"500px",margin:"10px"},src:F.value[0],"preview-src-list":F.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0),D.value.length!==0?(i(),y(a(b),{key:1,style:{width:"500px",height:"500px",margin:"10px"},src:D.value[0],"preview-src-list":D.value,fit:"scale-down"},null,8,["src","preview-src-list"])):p("",!0)])):p("",!0)]),_:1})])):p("",!0),_.value===3&&U.value.length!==0?(i(),w("div",Me,[s(be,{all_names:U.value},null,8,["all_names"])])):p("",!0)]),_:1})])],64))}});export{Jl as default};

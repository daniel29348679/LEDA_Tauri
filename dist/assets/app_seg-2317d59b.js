import{d as u}from"./pinia-71cafef5.js";import{b as o}from"./earthApi-baaacd65.js";import{b as i}from"./@vue-19632928.js";const r="poc-seg",d="ts_poc_seg",_=u("app-seg",()=>{const s=i({load:!1}),c=i(""),l=i([]),f=async e=>{const t=await o.api.initV8SegApiInitSegPost({name:r,model_name:e});return t==null||t.data.code==null?-1:t.data.code!==0?t.data.code:await n()},n=async()=>{const e=await o.api.infoV8SegApiInfoSegGet({name:r});if(console.log("res =>",e),e===void 0||e.data.code===void 0)return-1;if(e.data.code!==0)return e.data.code;if(s.value=e.data.result,e.data.result.doing&&e.data.result.result_image){let t=localStorage.getItem(d)??"";t===""&&(t=`${Date.now()}`,localStorage.setItem(d,t)),c.value=e.data.result.result_image+`&t=${t}`}return 0};return{info:s,imgURL:c,inferResult:l,init:f,checkInfo:n,startInfer:async(e,t)=>{const a=await o.api.startLiveInferV8SegApiStartLiveInferSegPost({name:r,cam_name:e,threshold:t});return console.log("res =>",a),a===void 0||a.data.code===void 0?-1:a.data.code!==0?a.data.code:await n()},stopInfer:async()=>{const e=await o.api.stopLiveInferV8SegApiStopLiveInferSegPost({name:r});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(localStorage.removeItem(d),s.value.doing=!1,0)},getInferResult:async()=>{const e=await o.api.inferV8SegLiveResultApiInferSegLiveResultGet({name:r});if(console.log("res =>",e),e===void 0||e.data.code===void 0)return-1;if(e.data.code,e.data.code!==0)return e.data.code;const t={};for(const a of e.data.result.last_result)t[a.label]===void 0?t[a.label]=1:t[a.label]++;return l.value=Object.keys(t).map(a=>({label:a,number:t[a]})),0}}});export{_ as u};

import{y as x,b as p,h as B,F as T,a7 as z,bI as s,u as t,o as N,ag as i,a as o,bf as f,aP as V,B as k,bz as C,aN as R}from"./@vue-19632928.js";import"./base-23d00206.js";import{a as S,E as M}from"./el-row-67417f48.js";import{E}from"./el-image-viewer-1a9f012d.js";import{E as I,a as D}from"./el-skeleton-item-b52dbad9.js";import{E as j}from"./el-space-cc9b6602.js";import{E as A,a as h}from"./el-table-column-5047dc3a.js";import"./el-checkbox-d46297b7.js";import"./el-tooltip-4ed993c7.js";import"./el-scrollbar-e3b486eb.js";/* empty css               */import{u as F,f as g,w as O}from"./index-d07dfee2.js";import{u as G}from"./app_defect_cls-7b84f4d7.js";import{u as K}from"./app_camera-ba436274.js";import{_ as P}from"./json-editor-vue3-5344cb8d.js";import"./lodash-es-cc4652a2.js";import"./typescript-defaf979.js";import"./index-b8931eed.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./vnode-18f2a975.js";import"./index-711061c4.js";import"./error-78e43d3e.js";import"./normalize-wheel-es-ed76fb12.js";import"./index-6127babd.js";import"./event-9519ab40.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";import"./jsoneditor-5f1e2c9e.js";const q=["disabled"],H=["disabled"],J={class:"display-middle w3-margin-top light-bar"},Q=x({__name:"ClassificationDefect",setup(W){const L=F(),v=K(),e=G(),r=p(""),u=p(!1),w=p(""),d=p("manual"),n=p([]);let c=!1;const $=async()=>{await e.stopInfer()},U=async()=>{await e.startInfer(e.info.cam_name,e.info.bypass,e.info.pass_values),b()},_=async()=>{if(c){try{let a=await e.checkInfo();if(a!==0){g(`check cls poc info fail : ${a}`);return}if(e.info.load||O("請先至後台設定分類應用"),a=await e.checkDetectInfo(),a!==0){g(`check cls defect info fail : ${a}`);return}if(e.info.doing){if(r.value=v.cameraURL(e.info.cam_name),a=await e.getInferResult(),a!==0){g(`get live inference result fail: ${a}`);return}w.value=e.detectResult,e.detectResult!==""&&(n.value.reverse(),n.value.push({label:e.inferResult,result:e.detectResult.toUpperCase(),time:new Date().toLocaleTimeString()}),n.value.reverse(),n.value.length>4&&(n.value=n.value.slice(0,4)))}else await b()}catch(a){g(`get live inference result fail: ${a}`)}setTimeout(_,1e3)}},b=async()=>{await v.checkCameraOpen(e.info.cam_name)?r.value=v.cameraURL(e.info.cam_name):r.value=""},y=()=>{c&&(u.value=!u.value,setTimeout(()=>y(),250))};return B(async()=>{console.log("分類計數器 init"),c=!0,b(),_(),y()}),T(async()=>{console.log("計數器 close"),c=!1}),(a,l)=>(N(),z(t(M),{gutter:10},{default:s(()=>[i(t(S),{span:8,sm:16,xs:24},{default:s(()=>[o("h4",null,f(a.$t("Dashboard.LiveImage")),1),i(t(I),{loading:r.value==="",animated:""},{template:s(()=>[i(t(D),{variant:"image",style:V({height:`${t(L).height-240}px`,width:"100%"})},null,8,["style"])]),default:s(()=>[i(t(E),{src:r.value,"preview-src-list":[r.value]},null,8,["src","preview-src-list"])]),_:1},8,["loading"]),i(t(j),{size:20},{default:s(()=>[o("span",null,[k(o("input",{class:"radio",type:"radio",name:"mode",id:"auto",value:"auto","onUpdate:modelValue":l[0]||(l[0]=m=>d.value=m)},null,512),[[C,d.value]]),l[4]||(l[4]=o("label",{for:"auto",class:"label"},"自動模式",-1))]),o("span",null,[k(o("input",{class:"radio",type:"radio",name:"mode",id:"manual",value:"manual","onUpdate:modelValue":l[1]||(l[1]=m=>d.value=m)},null,512),[[C,d.value]]),l[5]||(l[5]=o("label",{for:"manual",class:"label"},"手動模式",-1))]),o("button",{class:"w3-card pointer",onClick:l[2]||(l[2]=m=>U()),disabled:t(e).info.doing},f(a.$t("Button.Start")),9,q),o("button",{class:"w3-card pointer",onClick:l[3]||(l[3]=m=>$()),disabled:!t(e).info.doing},f(a.$t("Button.Stop")),9,H)]),_:1})]),_:1}),i(t(S),{span:8,sm:8,xs:24},{default:s(()=>[o("div",J,[o("div",{class:R(["w3-padding w3-jumbo w3-center w3-green light",[t(e).info.doing?"":"w3-disabled",w.value!=="pass"||!t(e).info.doing||!u.value?"w3-text-gray":"w3-text-white"]])}," OK ",2),o("div",{class:R(["w3-padding w3-jumbo w3-center w3-red light",[t(e).info.doing?"":"w3-disabled",w.value!=="ng"||!t(e).info.doing||!u.value?"w3-text-gray":"w3-text-white"]])}," NG ",2)]),o("h4",null,f(a.$t("Dashboard.DetectImage")),1),i(t(I),{loading:!t(e).info.doing||t(e).imgURL==="",animated:""},{template:s(()=>[i(t(D),{variant:"image",class:"w3-image",style:{height:"240px"}})]),default:s(()=>[i(t(E),{style:{width:"100%"},src:t(e).imgURL,"preview-src-list":[t(e).imgURL]},null,8,["src","preview-src-list"])]),_:1},8,["loading"]),i(t(A),{data:n.value,border:""},{default:s(()=>[i(t(h),{prop:"label",label:"分類"}),i(t(h),{prop:"result",label:"結果"}),i(t(h),{prop:"time",label:"時間"})]),_:1},8,["data"])]),_:1})]),_:1}))}});const Ne=P(Q,[["__scopeId","data-v-bf4b7c96"]]);export{Ne as default};

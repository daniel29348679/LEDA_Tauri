import{o as ot,r as le,f as ue,i as X,c as Qe,u as Ge,w as st,a as nt,b as it,d as rt,_ as ut,e as dt}from"./index-d07dfee2.js";import{b as oe,u as ct,c as pt,d as Se,e as ft,f as mt,g as Ve,h as Ae,i as de,j as ye,k as se,l as Be,C as we,m as vt,n as ht,o as We,p as bt,q as gt,r as Ue,s as yt,t as wt,v as _t,P as fe}from"./quasar-ff3737c6.js";import{y as ee,bu as kt,i as G,b as S,o as i,a7 as F,bI as a,ag as l,T as qe,u as e,B as ce,a as u,aM as Ct,bM as he,aN as W,c as _,b1 as ie,bf as $,a8 as U,bC as Ee,aP as $t,d as Y,af as T,h as pe,F as Ce,S as Z,n as St,w as Lt,b0 as me,bK as Et,J as Ft,ai as It}from"./@vue-19632928.js";import{l as Oe,_ as Pe}from"./SelectLang.vue_vue_type_script_setup_true_lang-90f9c456.js";import{b as Ke,u as Ie,_ as xe,w as Xe}from"./base-23d00206.js";/* empty css                  */import{E as De,a as _e,b as Re,c as Te}from"./el-main-e0dc383b.js";import{E as xt,a as Le,b as Vt}from"./el-menu-item-f0bf8d57.js";import"./el-tooltip-4ed993c7.js";import{E as Ne,a as At}from"./el-scrollbar-e3b486eb.js";import{E as Me,a as Bt}from"./el-skeleton-item-b52dbad9.js";import{E as Ze}from"./el-input-51d05b2a.js";import{R as je}from"./vue-router-841924de.js";import{u as Ut}from"./menu-87f92c89.js";import{u as Ot}from"./dashboard-f7b44aa1.js";import{d as Pt}from"./pinia-71cafef5.js";import{C as Dt}from"./pocketbase-7853bd73.js";import{E as Rt,a as ae}from"./el-button-ded9ecc1.js";import{S as Tt,E as Nt,a as Mt}from"./StashSelect-5af938b3.js";import{E as jt}from"./el-overlay-81162264.js";import{E as ze,a as zt}from"./el-checkbox-d46297b7.js";import{E as Ht}from"./el-progress-ed4e49af.js";import{a as Jt,b as Qt,c as Gt,f as He,s as Wt,u as qt}from"./@element-plus-a8abf029.js";import{l as Kt,_ as Xt}from"./lodash-3dc9162a.js";import{u as Zt}from"./stashSpace-391fdb88.js";import{_ as ve}from"./json-editor-vue3-5344cb8d.js";import{E as Yt}from"./el-card-a6aa41d5.js";/* empty css                        */import{E as Fe}from"./el-image-viewer-1a9f012d.js";import{K as el}from"./KonvaPaint-e9087f28.js";import{J as tl}from"./jszip-0fc1db0a.js";import{F as ll}from"./file-saver-4d1c0325.js";import{m as al,d as ol,u as sl,i as nl,e as il,c as rl}from"./label-61e62ece.js";import{u as ul,a as dl}from"./index-711061c4.js";import{u as Ye,a as et,E as tt,c as cl}from"./index-b8931eed.js";import{E as pl,a as fl,b as ml}from"./earthApi-baaacd65.js";import{d as vl,a as hl,u as bl}from"./use-dialog-b8544ca4.js";import{c as ke}from"./chinese-s2t-6c8e5e7a.js";import{E as gl}from"./el-popover-74fee5eb.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./axios-439bb627.js";import"./tiff.js-f0b72392.js";import"./@quasar-a9c09e53.js";import"./el-dropdown-item-a7576ad2.js";import"./@vueuse-0d360189.js";import"./dropdown-c44bb395.js";import"./lodash-es-cc4652a2.js";import"./refs-e3a131a0.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./vnode-18f2a975.js";import"./index-6127babd.js";import"./event-9519ab40.js";import"./index-32075738.js";/* empty css               */import"./el-select-99a9cb58.js";import"./validator-7d68535e.js";import"./jsoneditor-5f1e2c9e.js";import"./vue-drag-resize-6bf710ae.js";import"./decimal.js-d133ee8e.js";const yl=Ke({...vl,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),wl=hl,_l=ee({name:"ElDrawer",inheritAttrs:!1}),kl=ee({..._l,props:yl,emits:wl,setup(O,{expose:d}){const t=O,A=kt();ul({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},G(()=>!!A.title));const p=S(),L=S(),v=Ie("drawer"),{t:z}=Ye(),{afterEnter:I,afterLeave:y,beforeLeave:s,visible:P,rendered:B,titleId:M,bodyId:K,zIndex:w,onModalClick:k,onOpenAutoFocus:n,onCloseAutoFocus:c,onFocusoutPrevented:g,onCloseRequested:C,handleClose:D}=bl(t,p),V=G(()=>t.direction==="rtl"||t.direction==="ltr"),N=G(()=>et(t.size));return d({handleClose:D,afterEnter:I,afterLeave:y}),(E,re)=>(i(),F(e(fl),{to:E.appendTo,disabled:E.appendTo!=="body"?!1:!E.appendToBody},{default:a(()=>[l(qe,{name:e(v).b("fade"),onAfterEnter:e(I),onAfterLeave:e(y),onBeforeLeave:e(s),persisted:""},{default:a(()=>[ce(l(e(jt),{mask:E.modal,"overlay-class":E.modalClass,"z-index":e(w),onClick:e(k)},{default:a(()=>[l(e(pl),{loop:"",trapped:e(P),"focus-trap-el":p.value,"focus-start-el":L.value,onFocusAfterTrapped:e(n),onFocusAfterReleased:e(c),onFocusoutPrevented:e(g),onReleaseRequested:e(C)},{default:a(()=>[u("div",Ct({ref_key:"drawerRef",ref:p,"aria-modal":"true","aria-label":E.title||void 0,"aria-labelledby":E.title?void 0:e(M),"aria-describedby":e(K)},E.$attrs,{class:[e(v).b(),E.direction,e(P)&&"open"],style:e(V)?"width: "+e(N):"height: "+e(N),role:"dialog",onClick:he(()=>{},["stop"])}),[u("span",{ref_key:"focusStartRef",ref:L,class:W(e(v).e("sr-focus")),tabindex:"-1"},null,2),E.withHeader?(i(),_("header",{key:0,class:W([e(v).e("header"),E.headerClass])},[E.$slots.title?ie(E.$slots,"title",{key:1},()=>[U(" DEPRECATED SLOT ")]):ie(E.$slots,"header",{key:0,close:e(D),titleId:e(M),titleClass:e(v).e("title")},()=>[E.$slots.title?U("v-if",!0):(i(),_("span",{key:0,id:e(M),role:"heading","aria-level":E.headerAriaLevel,class:W(e(v).e("title"))},$(E.title),11,["id","aria-level"]))]),E.showClose?(i(),_("button",{key:2,"aria-label":e(z)("el.drawer.close"),class:W(e(v).e("close-btn")),type:"button",onClick:e(D)},[l(e(tt),{class:W(e(v).e("close"))},{default:a(()=>[l(e(cl))]),_:1},8,["class"])],10,["aria-label","onClick"])):U("v-if",!0)],2)):U("v-if",!0),e(B)?(i(),_("div",{key:1,id:e(K),class:W([e(v).e("body"),E.bodyClass])},[ie(E.$slots,"default")],10,["id"])):U("v-if",!0),E.$slots.footer?(i(),_("div",{key:2,class:W([e(v).e("footer"),E.footerClass])},[ie(E.$slots,"footer")],2)):U("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Ee,e(P)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Cl=xe(kl,[["__file","drawer.vue"]]);const $l=Xe(Cl),Sl=ee({name:"ImgEmpty"}),Ll=ee({...Sl,setup(O){const d=Ie("empty"),t=dl();return(A,p)=>(i(),_("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[u("defs",null,[u("linearGradient",{id:`linearGradient-1-${e(t)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[u("stop",{"stop-color":`var(${e(d).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),u("stop",{"stop-color":`var(${e(d).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),u("linearGradient",{id:`linearGradient-2-${e(t)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[u("stop",{"stop-color":`var(${e(d).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),u("stop",{"stop-color":`var(${e(d).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),u("rect",{id:`path-3-${e(t)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),u("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[u("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[u("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[u("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${e(d).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),u("polygon",{id:"Rectangle-Copy-14",fill:`var(${e(d).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),u("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[u("polygon",{id:"Rectangle-Copy-10",fill:`var(${e(d).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),u("polygon",{id:"Rectangle-Copy-11",fill:`var(${e(d).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),u("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${e(t)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),u("polygon",{id:"Rectangle-Copy-13",fill:`var(${e(d).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),u("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${e(t)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),u("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[u("use",{id:"Mask",fill:`var(${e(d).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${e(t)}`},null,8,["fill","xlink:href"]),u("polygon",{id:"Rectangle-Copy",fill:`var(${e(d).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${e(t)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),u("polygon",{id:"Rectangle-Copy-18",fill:`var(${e(d).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var El=xe(Ll,[["__file","img-empty.vue"]]);const Fl=Ke({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Il=ee({name:"ElEmpty"}),xl=ee({...Il,props:Fl,setup(O){const d=O,{t}=Ye(),A=Ie("empty"),p=G(()=>d.description||t("el.table.emptyText")),L=G(()=>({width:et(d.imageSize)}));return(v,z)=>(i(),_("div",{class:W(e(A).b())},[u("div",{class:W(e(A).e("image")),style:$t(e(L))},[v.image?(i(),_("img",{key:0,src:v.image,ondragstart:"return false"},null,8,["src"])):ie(v.$slots,"image",{key:1},()=>[l(El)])],6),u("div",{class:W(e(A).e("description"))},[v.$slots.description?ie(v.$slots,"description",{key:0}):(i(),_("p",{key:1},$(e(p)),1))],2),v.$slots.default?(i(),_("div",{key:0,class:W(e(A).e("bottom"))},[ie(v.$slots,"default")],2)):U("v-if",!0)],2))}});var Vl=xe(xl,[["__file","empty.vue"]]);const Al=Xe(Vl),Je=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);const Q=new Dt("/pb"),Bl=Pt("pocketbase",()=>{const O=S(!1),d=S(null),t=S("");Y([O,()=>Q.authStore.model],([k,n])=>{d.value=k&&n?n:null}),Y(d,()=>A());const A=()=>{t.value=d.value?Q.getFileUrl(d.value,d.value.avatar):""},p=S(!1),L=async()=>{try{if(Q.authStore.model){const{token:k,record:n}=await Q.collection(Q.authStore.model.collectionName).authRefresh();if(p.value=(n==null?void 0:n.role)==="admin",k)O.value=!0;else throw new Error("Login failed")}else p.value=!1,O.value=!1}catch{O.value=!1}},v=async()=>{await Q.collection("users").authRefresh(),d.value=Q.authStore.model,A()},z=async(k,n)=>{var g;const c=ot();try{const C=await Q.collection("users").authWithPassword(k,n);if(C.token)O.value=!0,p.value=((g=C.record)==null?void 0:g.role)==="admin",console.log(O.value,"isLogin"),le.push("/");else throw new Error("Login failed");return!0}catch{ue(X.global.t("Hint.LoginAgain")),p.value=!1,O.value=!1}finally{await c.close()}return!1},I=async(k,n)=>{try{if((await Q.collection("admins").authWithPassword(k,n)).token)O.value=!0,le.push("/");else throw new Error("Login failed");return!0}catch{ue(X.global.t("Hint.LoginAgain")),O.value=!1}return!1},y=()=>{Q.authStore.clear(),O.value=!1,le.push("/login")},s=async k=>{if(!d.value)return!1;const n=new FormData;n.append("avatar",k);const c=await Q.collection(d.value.collectionName).update(d.value.id,n);return await v(),c},P=async({oldPassword:k,password:n,passwordConfirm:c})=>{if(!d.value)return!1;try{if(await Q.collection(d.value.collectionName).update(d.value.id,{oldPassword:k,password:n,passwordConfirm:c}))return!0}catch{ue(X.global.t("Hint.ChangePasswordFail"))}finally{await y()}return!1},B=async()=>{try{return await Q.collection("users").getFullList({sort:"-created"})}catch{ue(X.global.t("Hint.FetchUsersFail"))}return null};return{authUser:d,avatarURL:t,isAdmin:p,checkLogin:L,userLogin:z,adminLogin:I,logout:y,updateAvatar:s,changePassword:P,fetchMembers:B,deleteUser:async k=>{try{const n=await Q.collection("users").delete(k);return console.log("deleteUser",n),n}catch{ue(X.global.t("Hint.DeleteUserFail"))}finally{await B()}return null},createMember:async k=>{try{return await Q.collection("users").create({...k,emailVisibility:!0})}catch{ue(X.global.t("Hint.CreateUserFail"))}return null},updateMember:async(k,n)=>{try{const c=await Q.collection("users").update(k,{...n,emailVisibility:!0});return c&&await v(),c}catch{ue(X.global.t("Hint.UpdateUserFail"))}return null},pb:Q}});const Ul={class:"upload-button-group q-mt-sm"},Ol=["disabled"],Pl=["disabled","accept","multiple"],Dl=["disabled"],Rl=ee({__name:"UploadButtonGroup",props:{accept:{},multiple:{type:Boolean},disabled:{type:Boolean},hideUpload:{type:Boolean},hideFile:{type:Boolean},hideFolder:{type:Boolean},hideEmpty:{type:Boolean},buttonUploadDisabled:{type:Boolean},buttonUploadText:{},buttonFileText:{},buttonFolderText:{},buttonEmptyText:{},onChange:{type:Function},onEmpty:{type:Function},onUpload:{type:Function}},setup(O){const d=O,t=G(()=>!(d.hideUpload??!1)),A=G(()=>!(d.hideFile??!1)),p=G(()=>!(d.hideFolder??!1)),L=G(()=>!(d.hideEmpty??!1)),v=y=>{const s=y.target.files;console.log("afterUpload = ",s),s&&s.length>0&&d.onChange&&d.onChange(s),d.hideFile||(document.getElementById("upload-file").value=""),d.hideFolder||(document.getElementById("upload-folder").value="")},z=()=>{d.onEmpty&&d.onEmpty()},I=()=>{d.onUpload&&d.onUpload()};return(y,s)=>(i(),_("div",Ul,[t.value?(i(),_("button",{key:0,class:"w3-btn w3-round w3-theme-l1 w3-hover-theme w3-ripple",onClick:I,disabled:d.disabled??!1},$(y.buttonUploadText?y.buttonUploadText:y.$t("Button.Upload",{name:y.$t("Label.File")})),9,Ol)):U("",!0),A.value?(i(),_("label",{key:1,for:"upload-file",class:W(["w3-btn w3-round w3-text-theme w3-border w3-border-theme w3-ripple",{"w3-disabled":d.buttonUploadDisabled??!1}])},[l(oe,{name:"fa-solid fa-file-circle-plus"}),T(" "+$(y.buttonFileText?y.buttonFileText:y.$t("Button.Select",{name:y.$t("Label.File")})),1)],2)):U("",!0),A.value?(i(),_("input",{key:2,id:"upload-file",onChange:v,class:"w3-hide",name:"upload-file",type:"file",disabled:d.buttonUploadDisabled??!1,accept:d.accept,multiple:d.multiple??!1},null,40,Pl)):U("",!0),p.value?(i(),_("label",{key:3,for:"upload-folder",class:W(["w3-btn w3-round w3-text-theme w3-border w3-border-theme w3-ripple",{"w3-disabled":d.buttonUploadDisabled??!1}])},[l(oe,{name:"fa-solid fa-folder-plus"}),T(" "+$(y.buttonFolderText?y.buttonFolderText:y.$t("Button.Select",{name:y.$t("Label.Folder")})),1)],2)):U("",!0),p.value?(i(),_("input",{key:4,id:"upload-folder",onChange:v,class:"w3-hide",name:"upload-folder",type:"file",disabled:d.buttonUploadDisabled??!1,webkitdirectory:"",directory:"",multiple:""},null,40,Dl)):U("",!0),L.value?(i(),_("button",{key:5,class:"w3-btn w3-round w3-text-red w3-border w3-border-red w3-ripple",onClick:s[0]||(s[0]=P=>z())},[l(oe,{name:"fa-solid fa-trash"}),T(" "+$(y.buttonEmptyText?y.buttonEmptyText:y.$t("Button.Empty",{name:y.$t("Label.File")})),1)])):U("",!0),ie(y.$slots,"default",{},void 0,!0)]))}});const Tl=ve(Rl,[["__scopeId","data-v-ee37275d"]]),Nl={class:"file-preview"},Ml={class:"header-container"},jl={class:"arrow-buttons"},zl={class:"title"},Hl={class:"close-button"},Jl={class:"content"},Ql={style:{width:"100%","max-height":"100%","overflow-y":"auto","white-space":"pre-wrap"}},Gl=["src"],Wl=ee({__name:"FilePreview",props:{fileList:{type:Array,required:!0},index:{type:Number,required:!0}},emits:["close","onChange"],setup(O,{emit:d}){const t=O,A=d,p=S(0);pe(()=>{p.value=t.index});const L=G(()=>{var w;return(w=t.fileList[p.value])==null?void 0:w.url}),v=G(()=>{var w;return(w=t.fileList[p.value])==null?void 0:w.filename}),z=[],I=S(""),y=()=>{p.value>0&&p.value--},s=()=>{p.value<t.fileList.length-1&&p.value++},P=()=>{A("close")};Y(()=>t.index,w=>{p.value=w}),Y(v,()=>{A("onChange",v.value,p.value)}),Y(()=>p.value,async w=>{var k,n,c;((k=t.fileList[w])!=null&&k.file_type.startsWith("text/")||(n=t.fileList[w])!=null&&n.file_type.startsWith("application/")||(c=t.fileList[w])!=null&&c.file_type.startsWith("image/tiff"))&&await M()}),pe(()=>{window.addEventListener("keydown",B)}),Ce(()=>{window.removeEventListener("keydown",B),z.forEach(w=>{URL.revokeObjectURL(w)})});const B=w=>{w.key==="ArrowUp"?(w.preventDefault(),p.value=Math.max(p.value-1,0)):w.key==="ArrowDown"&&(w.preventDefault(),p.value=Math.min(p.value+1,t.fileList.length-1))},M=async()=>{var n;const{file_type:w,url:k}=t.fileList[p.value]||{};try{const c=await fetch(k);if(!c.ok)throw new Error(`Failed to fetch file content: ${c.statusText}`);const g=(n=c.headers)==null?void 0:n.get("content-type");if(w==="image/tiff"){const C=await c.arrayBuffer(),V=new Tiff({buffer:C}).toCanvas(),N=await new Promise(E=>V.toBlob(E,w));I.value=await URL.createObjectURL(N),z.push(I.value)}else{const C=await c[w.startsWith("application/")&&(g!=null&&g.includes("application/json"))?"json":"text"]();I.value=w==="application/pdf"?C:JSON.stringify(C,null,0)}}catch(c){console.error(c)}};M();const K=()=>{const w=I.value.trimStart();navigator.clipboard.writeText(w).then(()=>{console.log("File content copied to clipboard:",w)}).catch(k=>{console.error("Failed to copy file content to clipboard:",k)})};return(w,k)=>(i(),_("div",Nl,[l(e(Yt),null,{header:a(()=>[u("div",Ml,[u("div",jl,[l(e(Rt),null,{default:a(()=>[l(e(ae),{onClick:y,icon:e(Jt)},null,8,["icon"]),l(e(ae),{onClick:s,icon:e(Qt)},null,8,["icon"])]),_:1})]),u("div",zl,$(v.value),1),u("div",Hl,[l(e(ae),{onClick:P,icon:e(Gt)},null,8,["icon"])])])]),default:a(()=>{var n,c,g,C,D,V;return[u("div",Jl,[L.value?(i(),_(Z,{key:0},[(n=t.fileList[p.value])!=null&&n.file_type.startsWith("image/tiff")?(i(),F(e(Fe),{key:0,src:I.value,alt:"Image","preview-src-list":[I.value],fit:"contain"},null,8,["src","preview-src-list"])):(c=t.fileList[p.value])!=null&&c.file_type.startsWith("image/")?(i(),F(e(Fe),{key:1,src:L.value,alt:"Image","preview-src-list":[t.fileList[p.value].url],fit:"contain"},null,8,["src","preview-src-list"])):(g=t.fileList[p.value])!=null&&g.file_type.startsWith("text/")||(C=t.fileList[p.value])!=null&&C.file_type.startsWith("application/xml")||(D=t.fileList[p.value])!=null&&D.file_type.startsWith("application/json")?(i(),_(Z,{key:2},[u("pre",Ql,$(I.value.trimStart())+`
          `,1),u("a",{class:"copy-button",onClick:K,type:"text"}," Copy ")],64)):(V=t.fileList[p.value])!=null&&V.file_type.startsWith("video/")&&L.value?(i(),_("video",{key:3,src:L.value,autoplay:"",style:{height:"100%"}},null,8,Gl)):U("",!0)],64)):(i(),_(Z,{key:1},[T($(v.value),1)],64))])]}),_:1})]))}});const ql=ve(Wl,[["__scopeId","data-v-6c669fe5"]]),Kl={class:"q-ml-sm text-white text-subtitle2"},Xl={class:"wrap"},Zl=["src","alt"],Yl={class:"w3-justify long-text"},ea=ee({__name:"ImageLabel",props:{modelValue:{type:Boolean,default:!1},files:{type:Array,default:()=>[]},dataName:{type:String,default:""},format:{type:Array,default:()=>["VOC","JSON"]},loading:{type:Boolean,default:!1}},emits:["update:modelValue","labelBlobExport","update:loading"],setup(O,{emit:d}){const t=O,A=ct(),p=S(null),L=S(null),v=S(null),z=G({get:()=>t.loading,set:o=>{I("update:loading",o)}});Y(p,async o=>{if(await St(),o&&(v.value===null&&(v.value=o.clientHeight),L.value===null)){const r=A.screen.lt.lg?0:330;L.value=Math.min(+al(v.value,Number(ol(16,9))),o.clientWidth-r)}},{immediate:!0});const I=d,y=G({get:()=>t.modelValue,set:o=>{if(!o){at();return}I("update:modelValue",o)}});Y(()=>y.value,o=>{o||s.resetLabel()});const s=sl(),P=S(""),B=S([]);Lt(async()=>{B.value=await Promise.all(s.imgs.filter(o=>o.path.indexOf(P.value)>-1).map(async o=>({...o,url:await nl(o.url)})))});const M=S(!1),K=o=>{const r=o.split("/");return r.length<5?r[r.length-1]:r.slice(4).join(" / ")},w=o=>{const r=o.lastIndexOf(".");return r===-1?o:o.substr(0,r)},k=S(["VOC","JSON"]),n=S(),c=S("VOC"),g=S([]),C=G(()=>{var o;return((o=t.files)==null?void 0:o.filter(r=>r.path.toLowerCase().split(".").pop()==="xml"))||[]}),D=G(()=>{var o;return((o=t.files)==null?void 0:o.filter(r=>r.path.toLowerCase().split(".").pop()==="json"))||[]}),V=G(()=>{var r,b;const o=[];return C.value.length>0&&((r=t.format)!=null&&r.includes("VOC"))&&o.push("VOC"),D.value.length>0&&((b=t.format)!=null&&b.includes("JSON"))&&o.push("JSON"),console.log("xmlFiles",C.value),console.log("jsonFiles",D.value),console.log("formatOptions",o),o});Y(()=>[V.value.length,t.format],()=>{var o;if((o=t.format)!=null&&o.length){t.format.includes("VOC")?(n.value="VOC",c.value="VOC"):t.format.includes("JSON")&&(n.value="JSON",c.value="JSON");return}V.value.length>0&&(n.value=V.value[0],c.value=V.value[0])},{immediate:!0});let N=[];const E=async(o,r,b)=>{var R;s.controlLock=!0,fe.show();try{for(const x of o){if(N.includes(x))continue;const H=s.imgs[x].name,j=r.find(J=>w(J.name)===w(H));if(j)try{if(!(j!=null&&j.url))continue;const J=await b(j.url),te=s.labelImgs.findIndex($e=>w($e.name)===w(H));g.value[te]={name:H,url:(R=s.imgs[x])==null?void 0:R.url,labels:J}}catch(J){console.error(J)}finally{N.push(x)}}}catch(x){console.error(x)}finally{fe.hide(),s.controlLock=!1}},re=async o=>{console.log("multiFilesHandle",o);const r=1,b=s.imgs[o].name,R=B.value.findIndex(J=>J.name===b),x=R-r<0?0:R-r,H=R+r>B.value.length-1?B.value.length-1:R+r,j=B.value.map(J=>s.imgs.findIndex(te=>te.name===J.name)).slice(x,H+1);switch(n.value){case"VOC":await E(j,C.value,s.handleXMLtoLabels);break;case"JSON":await E(j,D.value,s.handleJSONtoLabels);break}};pe(async()=>{N=[],M.value=!0,s.downloadProgress=0;try{await s.resetImage(t.files),console.log("labelStore.imgs",s.imgs),await h(0,s.imgs[0])}catch(o){console.error(o)}finally{M.value=!1}}),Y(()=>t.files,async()=>{const o=t.files.filter(r=>["jpg","jpeg","png","gif","tif","tiff"].indexOf(il(r.path))>-1);P.value="",N=[],g.value=[],M.value=!0;try{await s.resetImage(o),await h(0,s.imgs[0])}catch(r){console.error(r)}finally{M.value=!1}});let be=Date.now();const m=o=>{let r=0,b=0;const R=s.imgs[s.currentImage];if(r=B.value.findIndex(x=>x.name===R.name),!(Date.now()-be<250||s.controlLock))switch(be=Date.now(),o.key){case"ArrowUp":b=r-1,h(b,R);break;case"ArrowDown":b=r+1,h(b,R);break}};Ce(()=>{rl()});const f=S(),h=async(o,r=void 0)=>{var R;if(s.controlLock||s.controlLock||o<0||o>=B.value.length)return;let b=0;if(r){const x=B.value[o];b=s.imgs.findIndex(H=>H.name===(x==null?void 0:x.name))}else b=0;b<0||b>=s.imgs.length||(await s.setCurrentImage(s.imgs[b]),await re(b),(R=f.value)==null||R.scrollTo(o))};pe(()=>{window.addEventListener("keydown",m),k.value=t.format}),Ce(()=>{window.removeEventListener("keydown",m)});const q=async o=>{s.downloadProgress=1/(s.labelImgs.length+2);try{const r=new tl,b=await s.exportLabelFiles();for(const x of b){if(s.downloadProgress+=1/(s.labelImgs.length+2),o==="all"||o==="label"){const H=x.name.split("."),j=H.length>1?H.slice(0,-1).join("."):H[0];if(c.value==="VOC"){const J=s.handleLabelsToXML(x),te=new Blob([J],{type:"text/xml"});r.file(`${j}.xml`,te)}if(c.value==="JSON"){const J=s.handleLabelsToJSON(x),te=JSON.stringify(J,null,2),$e=new Blob([te],{type:"text/json"});r.file(`${j}.json`,$e)}}if(o==="all"||o==="img"&&c.value==="VOC"){const H=await fetch(x.url).then(j=>j.blob());r.file(x.name,H)}}const R=await r.generateAsync({type:"blob"});s.downloadProgress+=1/(s.labelImgs.length+2),ll.saveAs(R,`${t.dataName}.zip`)}catch(r){console.error(r)}finally{s.loading=!1,s.downloadProgress=0}},ne=o=>{const r=o.split(".");return r.length>1?r.slice(0,-1).join("."):r[0]},ge=async o=>{const r=[],b=c.value===n.value,R=[];await fe.show(),z.value=!0;try{for(const x of o){const H=ne(x.name);if(!(b&&!x.isActive)){if(x.isActive&&x.labels.length===0){c.value==="VOC"?R.push(`${H}.xml`):c.value==="JSON"&&R.push(`${H}.json`);continue}if(c.value==="VOC"){const j=s.handleLabelsToRectLabel(x.labels);if(!j.length)continue;const J=s.handleLabelsToXML({...x,labels:j}),te=new Blob([J],{type:"text/xml"});r.push({name:`${H}.xml`,blob:te}),n.value="VOC"}if(c.value==="JSON"){const j=s.handleLabelsToJSON(x);if(!j.shapes.length)continue;const J=JSON.stringify(j,null,2),te=new Blob([J],{type:"text/json"});r.push({name:`${H}.json`,blob:te}),n.value="JSON"}}}await I("labelBlobExport",r,R)}catch(x){console.error(x)}finally{await fe.hide(),z.value=!1}},lt=async()=>{if(M.value){await fe.show();const o=setInterval(async()=>{M.value||(fe.hide(),await clearInterval(o))},100)}},at=async()=>{s.labelImgs.some(r=>r.isActive)?await Qe({message:X.global.t("Hint.UnsavedChangesConfirmation"),onOk:async()=>{I("update:modelValue",!1)},onCancel:async()=>{I("update:modelValue",!0)}}):I("update:modelValue",!1)};return(o,r)=>(i(),_("span",{class:"q-ml-sm",key:t.dataName},[V.value.length>1?(i(),F(pt,{key:0,class:"format-select",modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=b=>n.value=b),options:V.value,style:{width:"110px"},label:o.$t("Format"),outlined:"",dense:""},null,8,["modelValue","options","label"])):U("",!0),l(_t,{modelValue:y.value,"onUpdate:modelValue":r[7]||(r[7]=b=>y.value=b),maximized:"","full-height":"","full-width":"",style:{zIndex:1e3},"no-esc-dismiss":"",onBeforeShow:lt,"auto-close":!1},{default:a(()=>[l(Se,{class:"image-label-wrap"},{default:a(()=>[e(s).downloadProgress>0?(i(),F(ft,{key:0,size:"5px",value:e(s).downloadProgress,color:"positive"},null,8,["value"])):U("",!0),l(mt,{class:"bg-primary q-pa-none label-window-bar"},{default:a(()=>[l(Ve,{"text-color":"white",stretch:"",flat:"",label:o.$t("Label.File")},{default:a(()=>[l(Ae,null,{default:a(()=>[l(de,{header:""},{default:a(()=>[T($(o.$t("Download")),1)]),_:1}),ce((i(),F(ye,{clickable:"",tabindex:"0",onClick:r[1]||(r[1]=b=>q("all")),disable:e(s).downloadProgress>0},{default:a(()=>[l(se,{avatar:""},{default:a(()=>[l(Be,{icon:"folder",color:"secondary","text-color":"white"})]),_:1}),l(se,null,{default:a(()=>[l(de,null,{default:a(()=>[T($(o.$t("AllDownload")),1)]),_:1}),l(de,{caption:""},{default:a(()=>[T($(t.dataName),1)]),_:1})]),_:1}),l(se,{side:""},{default:a(()=>[l(oe,{name:"download"})]),_:1})]),_:1},8,["disable"])),[[we]]),ce((i(),F(ye,{clickable:"",tabindex:"0",onClick:r[2]||(r[2]=b=>q("img"))},{default:a(()=>[l(se,{avatar:""},{default:a(()=>[l(Be,{icon:"image",color:"secondary","text-color":"white"})]),_:1}),l(se,null,{default:a(()=>[l(de,null,{default:a(()=>[T($(o.$t("Label.Picture")),1)]),_:1}),l(de,{caption:""},{default:a(()=>{var b;return[T($((b=e(s).labelImgs)==null?void 0:b.length),1)]}),_:1})]),_:1}),l(se,{side:""},{default:a(()=>[l(oe,{name:"download"})]),_:1})]),_:1})),[[we]]),l(vt,{inset:"",spaced:""}),ce((i(),F(ye,{clickable:"",tabindex:"0",onClick:r[3]||(r[3]=b=>y.value=!1)},{default:a(()=>[l(se,null,{default:a(()=>[l(de,null,{default:a(()=>[T($(o.$t("Button.Close")),1)]),_:1})]),_:1})]),_:1})),[[we]])]),_:1})]),_:1},8,["label"]),l(Ve,{"text-color":"white",stretch:"",flat:"",label:o.$t("SaveFormat")},{default:a(()=>[l(Ae,null,{default:a(()=>[(i(),_(Z,null,me(["VOC","JSON"],b=>ce(l(ye,{key:b,clickable:"",tabindex:"0",onClick:R=>c.value=b},{default:a(()=>[l(se,null,{default:a(()=>[l(de,null,{default:a(()=>[T($(b),1)]),_:2},1024)]),_:2},1024),l(se,{side:""},{default:a(()=>[c.value===b?(i(),F(oe,{key:0,name:"check_circle_outline",color:"green"})):U("",!0)]),_:2},1024)]),_:2},1032,["onClick"]),[[we]])),64))]),_:1})]),_:1},8,["label"]),u("span",Kl,$(c.value),1),l(ht),l(We,{flat:"",round:"",dense:"",icon:"close",color:"white",onClick:r[4]||(r[4]=b=>y.value=!1)})]),_:1}),u("div",Xl,[l(Se,{class:"left q-pa-sm"},{default:a(()=>[e(s).imgs.length>0?(i(),F(bt,{key:0,class:"q-mb-sm",modelValue:P.value,"onUpdate:modelValue":r[5]||(r[5]=b=>P.value=b),placeholder:o.$t("FilterName"),clearable:"",outlined:"",dense:"",onClear:r[6]||(r[6]=b=>P.value="")},null,8,["modelValue","placeholder"])):U("",!0),l(gt,{ref_key:"scrollRef",ref:f,class:"scroll-bar",items:B.value,"virtual-scroll-item-size":179,"virtual-scroll-sticky-size-start":0,"virtual-scroll-sticky-size-end":179},{default:a(({item:b})=>[(i(),F(Se,{class:W(["q-pa-sm","pointer",e(s).isCurrentImage(b)?"bg-primary w3-text-white":""]),onClick:R=>h(B.value.indexOf(b),b),title:K(b.name),key:b.name},{default:a(()=>[l(Ue,{class:"q-pa-none"},{default:a(()=>[u("img",{style:{width:"100%","max-height":"100px"},src:b.url,alt:K(b.name),class:"padding-4 w3-border w3-white w3-round"},null,8,Zl)]),_:2},1024),l(Ue,{class:"q-pa-none"},{default:a(()=>[u("div",Yl,$(b.name),1)]),_:2},1024)]),_:2},1032,["class","onClick","title"]))]),_:1},8,["items"])]),_:1}),u("div",{ref_key:"contentRef",ref:p,class:"right"},[!M.value&&e(s).imgs.length>0&&L.value&&L.value>0&&v.value&&v.value>0?(i(),F(el,{key:0,"visible-tools":e(A).screen.lt.sm?["move","rect","poly","pen","polygon","eraser","move"]:["move","rect","poly","pen","polygon","eraser","zoom-in","zoom-out","move"],"set-info":ge,width:L.value,height:v.value,fileLabels:g.value,initArray:e(N),"is-zoom-out":"","is-tool-parent":"","save-text":o.$t("Button.Save")},null,8,["visible-tools","width","height","fileLabels","initArray","save-text"])):U("",!0)],512)]),l(yt,{showing:z.value||e(s).loading},{default:a(()=>[l(wt,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})]),_:1},8,["modelValue"])]))}});const ta=ve(ea,[["__scopeId","data-v-ebb957f7"]]),la={class:"stash-space"},aa={class:"stash-space-content"},oa={class:"container"},sa={class:"left"},na={class:"button-area"},ia={class:"file-wrap"},ra={class:"file-list-flex"},ua={key:0,class:"right"},da={style:{flex:"auto"}},ca=ee({__name:"IndexPage",setup(O){const d=Ge(),t=Zt(),A=S(!1),p=S([]),L=S([]),v=S(""),z=Kt.debounce(()=>{L.value=t.spaceFiles.filter(m=>m.filename.toLowerCase().includes(v.value.toLowerCase()))},300),I=S(!1),y=S(""),s=S(0);pe(()=>{t.fetchSpaceIsLocal()});const P=()=>{z()};Y(()=>t.spaceFiles,()=>{P()});const B=async m=>{!(m!=null&&m.length)||!await t.fetchRemoveFile(m)||(t.setSpaceFiles(t.spaceFiles.filter(h=>!p.value.includes(h.filename))),v.value="",p.value=[])},M=m=>{m()},K=(m,f)=>{m!==f&&V()},w=()=>{v.value="",P()},k=()=>{V()},n=async m=>{const f=Array.from(m);await t.fetchSpaceUpload(f)},c=m=>{m?p.value=Array.from(new Set([...p.value,...L.value.map(f=>f.filename)])):p.value=p.value.filter(f=>!L.value.find(h=>h.filename===f))},g=async()=>{const m=v.value.toString(),f=p.value.map(h=>{var q;return(q=t.spaceFiles.find(ne=>ne.filename===h))==null?void 0:q.filename});v.value="",P(),Mt.confirm(X.global.t("Hint.SureToDeleteFiles",{count:f.length})).then(async()=>{await B(f)}).finally(()=>{v.value=m,P()})};Y(L,m=>{const f=p.value.filter(h=>m.find(q=>q.filename===h));A.value=f.length===m.length});const C=m=>{y.value=m.filename,s.value=L.value.findIndex(f=>m.filename===f.filename),I.value=!0},D=(m,f)=>{s.value=f,y.value=m},V=()=>{t.setSpaceFiles([]),p.value=[],v.value="",I.value=!1},N=S(!1);function E(m){const f=new DataTransfer;return m.forEach(h=>f.items.add(h)),f.files}const re=async(m,f)=>{if(console.log(f,"removeList"),!m.length&&!f.length){st(X.global.t("NoChangeLabel"));return}let h="";m.length>0&&(h+=`<div class="text-secondary">${X.global.t("Button.Add")}: </div> ${m.map(q=>q.name).join("<br/>")}<br/><br/>`),f.length>0&&(h+=`<div class="text-negative">${X.global.t("Button.Remove")}:</div> ${f.join("<br/>")}`),h=h.trim(),Qe({title:X.global.t("EditFileConfirmation"),message:h,onOk:async()=>{const q=m.map(ge=>be(ge.blob,ge.name)),ne=E(q);N.value=!1,await B(f),await n(ne)}})},be=(m,f)=>{const h=m;return h.lastModifiedDate=new Date,h.name=f,new File([m],f,{type:m.type,lastModified:Date.now()})};return(m,f)=>(i(),_("div",la,[e(d).gt.xs?(i(),F(e(ae),{key:0,round:"",icon:e(He),onClick:f[0]||(f[0]=h=>e(t).openSpace()),color:"primary"},{default:a(()=>[T($(m.$t("StashSpace")),1)]),_:1},8,["icon"])):(i(),F(e(ae),{key:1,round:"",icon:e(He),onClick:f[1]||(f[1]=h=>e(t).openSpace()),color:"primary"},null,8,["icon"])),l(e($l),{modelValue:e(t).drawerVisible,"onUpdate:modelValue":f[11]||(f[11]=h=>e(t).drawerVisible=h),title:m.$t("StashSpace"),size:"90%","before-close":M},{footer:a(()=>[u("div",da,[p.value.length?(i(),F(e(ae),{key:0,type:"danger",onClick:g,disabled:e(t).loading},{default:a(()=>[T($(m.$t("Button.DeleteSelected")),1)]),_:1},8,["disabled"])):U("",!0)])]),default:a(()=>[u("div",aa,[e(t).loading&&e(t).currentLoading?(i(),F(e(Ht),{key:0,percentage:e(t).currentLoading},null,8,["percentage"])):U("",!0),l(Tt,{onOnChanged:K,onOnViewed:w,onOnDestroyed:k},{default:a(()=>[l(We,{class:"q-ml-sm",onClick:f[2]||(f[2]=h=>N.value=!N.value),color:"primary",glossy:"",disable:e(t).spaceFiles.length<=0},{default:a(()=>[T($(m.$t("Button.View",{name:m.$t("Label.Label")})),1)]),_:1},8,["disable"]),l(ta,{modelValue:N.value,"onUpdate:modelValue":f[3]||(f[3]=h=>N.value=h),"data-name":e(t).currentSpace,onLabelBlobExport:re,files:e(t).spaceFiles.map(h=>({name:(h==null?void 0:h.filename)??"",url:(h==null?void 0:h.url)??"",path:(h==null?void 0:h.filename)??""}))},null,8,["modelValue","data-name","files"])]),_:1}),u("div",oa,[u("div",sa,[u("div",na,[l(Tl,{multiple:"","hide-upload":!0,hideEmpty:!0,hideFile:e(t).isLocal,hideFolder:e(t).isLocal,accept:"*/*","button-upload-disabled":!e(t).currentSpace||e(t).loading,"on-change":n,"button-file-text":m.$t("Button.Upload",{name:m.$t("Label.File")}),"button-folder-text":m.$t("Button.Upload",{name:m.$t("Label.Folder")})},{default:a(()=>[e(t).isLocal?(i(),F(e(ae),{key:0,class:"w3-btn w3-round w3-text-theme w3-border w3-border-theme w3-ripple",plain:"",onClick:f[4]||(f[4]=()=>e(t).fetchLocationFile(!0)),disabled:!e(t).currentSpace||e(t).loading},{default:a(()=>[l(oe,{name:"fa-solid fa-file-circle-plus"}),T("  "+$(m.$t("Button.Upload",{name:m.$t("Label.File")})),1)]),_:1},8,["disabled"])):U("",!0),e(t).isLocal?(i(),F(e(ae),{key:1,class:"w3-btn w3-round w3-text-theme w3-border w3-border-theme w3-ripple",plain:"",onClick:f[5]||(f[5]=()=>e(t).fetchLocationFile(!1)),disabled:!e(t).currentSpace||e(t).loading},{default:a(()=>[l(oe,{name:"fa-solid fa-folder-plus"}),T("  "+$(m.$t("Button.Upload",{name:m.$t("Label.Folder")})),1)]),_:1},8,["disabled"])):U("",!0)]),_:1},8,["hideFile","hideFolder","button-upload-disabled","button-file-text","button-folder-text"])]),l(e(Ze),{class:"search-input",modelValue:v.value,"onUpdate:modelValue":f[6]||(f[6]=h=>v.value=h),onKeydown:Et(P,["enter"]),onClear:P,placeholder:m.$t("Label.Search"),disabled:!e(t).spaceFiles.length,clearable:""},{append:a(()=>[l(e(ae),{icon:e(Wt),onClick:P},null,8,["icon"])]),_:1},8,["modelValue","placeholder","disabled"]),u("div",ia,[L.value.length?(i(),_(Z,{key:1},[l(e(ze),{modelValue:A.value,"onUpdate:modelValue":f[7]||(f[7]=h=>A.value=h),onChange:c},{default:a(()=>[T($(m.$t("Label.SelectAll")),1)]),_:1},8,["modelValue"]),u("div",ra,[(i(!0),_(Z,null,me(L.value,(h,q)=>(i(),_("div",{key:q,class:"file-item"},[l(e(zt),{modelValue:p.value,"onUpdate:modelValue":f[9]||(f[9]=ne=>p.value=ne)},{default:a(()=>[(i(),F(e(ze),{class:"file-checkbox",label:h.filename,key:h.filename},{default:a(()=>[u("label",{onClick:f[8]||(f[8]=he(()=>{},["stop"]))},[l(e(Nt),{class:W(["file-item-link custom-tooltip",{active:y.value===h.filename}]),title:y.value,underline:!1,onClick:ne=>C(h)},{default:a(()=>[T($(h.filename),1)]),_:2},1032,["title","class","onClick"])])]),_:2},1032,["label"]))]),_:2},1032,["modelValue"])]))),128))])],64)):(i(),F(e(Al),{key:0,description:m.$t("NoData")},null,8,["description"]))])]),I.value?(i(),_("div",ua,[l(ql,{"file-list":L.value,index:s.value,onOnChange:D,onClose:f[10]||(f[10]=()=>I.value=!1)},null,8,["file-list","index"])])):U("",!0)])])]),_:1},8,["modelValue","title"])]))}});const pa=ve(ca,[["__scopeId","data-v-94d7d4d9"]]),fa={class:"user-avatar-error"},ma={class:"w3-center"},va=ee({__name:"HeaderUserInfo",setup(O){const d=S(""),t=S(""),A=async()=>{await ml.api.seadeepLogoutApiLogoutPost(),await le.push({path:"login"})};return pe(async()=>{}),(p,L)=>(i(),F(e(gl),{trigger:"click",width:"250px"},{reference:a(()=>[l(e(Fe),{fit:"cover",class:"w3-circle pointer",style:{height:"50px",width:"50px",cursor:"pointer",border:"2px solid #ffffff"}},{error:a(()=>[u("div",fa,[l(e(tt),{style:{"vertical-align":"middle"},size:20,type:"primary",color:"#FFF"},{default:a(()=>[l(e(qt))]),_:1})])]),_:1})]),default:a(()=>[u("div",ma,[u("b",null,$(d.value),1),u("p",null,"(租戶: "+$(t.value)+")",1),l(e(ae),{onClick:L[0]||(L[0]=v=>A())},{default:a(()=>[u("b",null,$(p.$t("Button.Logout")),1)]),_:1})])]),_:1}))}});const ha=ve(va,[["__scopeId","data-v-94580f88"]]),ba={key:1,class:"common-layout"},ga={class:"w3-text-red"},ya={key:3,class:"common-layout"},wa={class:"header-logo"},_a={class:"version-tip"},ka={class:"header-right"},Ca={class:"filter-mnu-input"},$a={class:"cut-text"},Sa={key:1},La={class:"main-page"},Ea=ee({__name:"App",setup(O){const d=Ge(),t={VITE_BASE:"dev",VITE_APP_VERSION:"v4.4.0",VITE_LITE_VERSION:"v1.0.0",VITE_API_URL:"https://leda-app.seadeep.ai",VITE_API_SWAGGER_OUTPUT_FILE:"earth.ts",VITE_API_SWAGGER_URL:"https://leda-app.seadeep.ai/openapi/openapi.json",VITE_APP_MEMBER:"false",VITE_SEADEEP_AUTH:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};pe(()=>{window.addEventListener("resize",d.handleResize)}),Ce(()=>{window.removeEventListener("resize",d.handleResize)});const A=typeof window<"u"?It(()=>ut(()=>import("./ReloadPrompt-2d35e434.js"),["assets/ReloadPrompt-2d35e434.js","assets/index-d07dfee2.js","assets/@vue-19632928.js","assets/quasar-ff3737c6.js","assets/quasar-7e355eb4.css","assets/pinia-71cafef5.js","assets/vue-konva-50f8b9a5.js","assets/konva-364a8bb7.js","assets/@logicflow-db5a80c3.js","assets/@logicflow-8a2c5ed0.css","assets/vue-router-841924de.js","assets/vue-i18n-76143ed6.js","assets/@intlify-0ef9a929.js","assets/axios-439bb627.js","assets/tiff.js-f0b72392.js","assets/jszip-0fc1db0a.js","assets/@quasar-a9c09e53.js","assets/@quasar-a219b8d1.css","assets/index-24d9d9cb.css","assets/base-23d00206.js","assets/lodash-es-cc4652a2.js","assets/base-e3823977.css","assets/StashSelect-5af938b3.js","assets/el-select-99a9cb58.js","assets/el-scrollbar-e3b486eb.js","assets/@vueuse-0d360189.js","assets/error-78e43d3e.js","assets/index-6127babd.js","assets/index-b8931eed.js","assets/earthApi-baaacd65.js","assets/index-711061c4.js","assets/el-scrollbar-c438fc05.css","assets/index-32075738.js","assets/el-button-ded9ecc1.js","assets/@ctrl-f8748455.js","assets/el-button-f2767652.css","assets/event-9519ab40.js","assets/el-select-0e10cbe0.css","assets/el-input-51d05b2a.js","assets/typescript-defaf979.js","assets/el-input-1dbd76e7.css","assets/el-overlay-81162264.js","assets/vnode-18f2a975.js","assets/el-overlay-6e0625dd.css","assets/el-tooltip-4ed993c7.js","assets/@element-plus-a8abf029.js","assets/stashSpace-391fdb88.js","assets/validator-7d68535e.js","assets/json-editor-vue3-5344cb8d.js","assets/jsoneditor-5f1e2c9e.js","assets/jsoneditor-c4f3181c.css","assets/json-editor-vue3-f2944aab.css","assets/StashSelect-0917b3ac.css","assets/el-tag-afac09bb.css"])):null,p=Ut(),L=S([]),v=S(""),z=G(()=>{var g;const n=(g=ke.s2t(v.value))==null?void 0:g.toLowerCase();return n?Xt(p.MenuList).filter(C=>{var V;const D=(V=ke.s2t(C.title))==null?void 0:V.toLowerCase();if(D!=null&&D.includes(n))return!0;if(C.sub){const N=C.sub.filter(E=>{var re;return(re=ke.s2t(E.title))==null?void 0:re.toLowerCase().includes(n)});if(N.length>0)return C.path&&L.value.push(C.path),C.sub=N,!0}return!1}).map(C=>(C.sub&&(C.sub=C.sub.filter(D=>{var V;return(V=ke.s2t(D.title))==null?void 0:V.toLowerCase().includes(n)})),C)):p.MenuList}),I=Ot(),y=S(!1),s=S(2),P=Bl(),B=S(!1),M=n=>n.path==="/member"&&!P.isAdmin;Y(le.currentRoute,async n=>{n.name==="dashboard"&&I.enableItems.length>0&&await le.push(I.enableItems[0].path)});const K=async()=>{s.value++,s.value>6&&(s.value=3);const n=await dt("json","/api/health",void 0,"POST",{username:"LEDA"},!1);if(console.log("health => ",n),!n||n.status!==200){setTimeout(K,1e3);return}y.value=!0,p.MenuList.findIndex(c=>c.path&&c.path.startsWith("/dashboard"))>-1&&await I.load()},w=n=>{B.value=n,n?localStorage.setItem("collapsed","1"):localStorage.setItem("collapsed","0")};Ft(async()=>{console.info("v3.0.0");const n=localStorage.getItem("collapsed");n!==null?B.value=n=="1":B.value=Je(),await K()});const k=n=>{window.open(n,"_blank")};return(n,c)=>(i(),_(Z,null,[e(A)?(i(),F(e(A),{key:0})):U("",!0),y.value?e(le).currentRoute.value.name==="logicflow"||e(le).currentRoute.value.name==="login"||e(le).currentRoute.value.path.startsWith("/dashboard")&&e(le).currentRoute.value.path!=="/dashboard-setting"?(i(),F(e(je),{key:2})):(i(),_("div",ya,[l(e(_e),{style:{height:"100vh",overflow:"hidden"}},{default:a(()=>[l(e(De),{class:"header"},{default:a(()=>[u("div",{class:"menu-aside-expand",onClick:c[0]||(c[0]=g=>w(!B.value))},[l(oe,{name:"fa-solid fa-bars"})]),u("div",wa,[c[5]||(c[5]=u("img",{src:Oe,alt:"LEDA"},null,-1)),u("span",_a,$(e(t).VITE_APP_VERSION),1)]),u("div",ka,[e(nt)()&&(e(it)()||e(rt)())?(i(),F(ha,{key:0})):U("",!0),l(Pe,{"on-change":g=>{e(p).changeLang(g)}},null,8,["on-change"]),l(pa)])]),_:1}),c[6]||(c[6]=u("div",{class:"header-block"},null,-1)),l(e(_e),null,{default:a(()=>[ce(u("div",{class:"mobile-aside-mask",onClick:c[1]||(c[1]=g=>w(!0))},null,512),[[Ee,!B.value&&e(d).lt.xs]]),l(qe,{name:"menu"},{default:a(()=>[ce(l(e(Re),{class:"menu-aside"},{default:a(()=>[l(e(Ne),{class:"scrollbar"},{default:a(()=>[u("div",Ca,[l(e(Ze),{modelValue:v.value,"onUpdate:modelValue":c[2]||(c[2]=g=>v.value=g),placeholder:n.$t("Button.Search"),clearable:""},null,8,["modelValue","placeholder"])]),z.value.length>0?(i(),F(e(xt),{key:0,"default-active":e(le).currentRoute.value.path.replace("/",""),router:""},{default:a(()=>[(i(!0),_(Z,null,me(z.value,(g,C)=>{var D;return i(),_(Z,null,[g.onClick!==void 0?(i(),F(e(Le),{key:`link_${C}`,onClick:g.onClick,onAuxclick:he(()=>k(g.path??""),["prevent"]),index:""},{default:a(()=>[T($(g.title)+"   ",1),l(oe,{name:"fa-solid fa-arrow-up-right-from-square"})]),_:2},1032,["onClick","onAuxclick"])):(g.sub??[]).length===0&&!M(g)?(i(),F(e(Le),{key:C,index:g.path==="/"?"/":(D=g.path)==null?void 0:D.replace("/",""),onAuxclick:he(()=>k(g.path??""),["prevent"])},{default:a(()=>[T($(g.title),1)]),_:2},1032,["index","onAuxclick"])):(i(),F(e(Vt),{key:`sub-${C}`,index:`${C}`},{title:a(()=>[T($(g.title),1)]),default:a(()=>[(i(!0),_(Z,null,me(g.sub,(V,N)=>(i(),F(e(Le),{key:N,index:V.path,onAuxclick:he(()=>k(V.path??""),["prevent"])},{default:a(()=>[V.title.length>20?(i(),F(e(At),{key:0,content:V.title,placement:"right-start"},{default:a(()=>[u("div",$a,$(V.title),1)]),_:2},1032,["content"])):(i(),_("span",Sa,$(V.title),1))]),_:2},1032,["index","onAuxclick"]))),128))]),_:2},1032,["index"]))],64)}),256))]),_:1},8,["default-active"])):U("",!0)]),_:1})]),_:1},512),[[Ee,!B.value]])]),_:1}),l(e(Te),{class:"main"},{default:a(()=>[l(e(Ne),{class:"main-scrollbar",onScroll:e(d).setScrollPosition},{default:a(()=>[u("div",La,[l(e(je))])]),_:1},8,["onScroll"])]),_:1})]),_:1})]),_:1})])):(i(),_("div",ba,[l(e(_e),{style:{height:"100vh"}},{default:a(()=>[l(e(De),{class:"header"},{default:a(()=>[c[3]||(c[3]=u("img",{class:"header-logo",src:Oe,alt:"LEDA",style:{height:"50px"}},null,-1)),l(Pe,{style:{position:"absolute",right:"36px"},"on-change":g=>{e(p).changeLang(g)}},null,8,["on-change"])]),_:1}),c[4]||(c[4]=u("div",{class:"header-block"},null,-1)),l(e(_e),null,{default:a(()=>[e(Je)()?U("",!0):(i(),F(e(Re),{key:0,width:"250px",class:"w3-padding"},{default:a(()=>[l(e(Me),{animated:""},{template:a(()=>[(i(),_(Z,null,me(24,g=>l(e(Bt),{key:g,variant:"h1"})),64))]),_:1})]),_:1})),l(e(Te),null,{default:a(()=>[u("h1",ga,[T($(n.$t("Hint.Starting"))+" ",1),(i(!0),_(Z,null,me(s.value,g=>(i(),_("span",{key:g},"."))),128))]),l(e(Me),{rows:12,animated:""})]),_:1})]),_:1})]),_:1})]))],64))}});const No=ve(Ea,[["__scopeId","data-v-e03797cf"]]);export{No as default};

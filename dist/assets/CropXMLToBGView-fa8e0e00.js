import"./base-23d00206.js";import{E as U,a as A}from"./el-steps-c8cdef54.js";import{E as V}from"./el-divider-67eeba91.js";import{a as w}from"./el-button-ded9ecc1.js";import{c as W}from"./el-main-e0dc383b.js";import{E as L}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as j}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as q}from"./el-form-item-62aac1b2.js";import{E as H}from"./el-input-51d05b2a.js";import{E as F}from"./el-checkbox-d46297b7.js";import{d as B,o as J,h as K,p as O}from"./@element-plus-a8abf029.js";import{u as Q,w as h,i as $,o as Y,f as N}from"./index-d07dfee2.js";import{u as Z}from"./uploadFileBG-e207f860.js";import{u as x}from"./stashSpace-391fdb88.js";import{S as M}from"./StashSelect-5af938b3.js";import{R as ee}from"./ResultImgWithStash-c075e0f0.js";import{E as P}from"./index-b8931eed.js";import{y as le,h as te,b as u,c as f,a as p,bf as r,ag as o,u as l,bI as s,S as oe,o as d,af as _,a7 as T,a8 as g}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./event-9519ab40.js";import"./vnode-18f2a975.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./refs-e3a131a0.js";import"./async-validator-dee29e8b.js";import"./index-6127babd.js";import"./index-32075738.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import"./el-tooltip-4ed993c7.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-image-viewer-1a9f012d.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const ae={class:"step-page"},se={class:"step-nav"},ie={key:0},re={key:0},ue={class:"el-upload__tip"},pe={class:"el-upload__text"},ne={class:"el-upload__tip"},de={key:1},me={key:0,style:{"margin-bottom":"10px"}},ve={class:"el-upload__tip"},fe={class:"el-upload__tip"},ce=["src"],_e={key:2},hl=le({__name:"CropXMLToBGView",setup(ge){const D=Q(),c=x();te(()=>{console.log("CropXMLToBG"),c.spaceSelected=[]});const n=u(1),y=u("v1"),m=u([]),v=u([]),C=Z(),I=u(""),E=u(!1),S=u([]),i=u(!1),b=u(""),k=u(""),G=()=>{if(i.value&&(b.value=c.currentFolderPath,c.spaceSelected=[]),i.value&&b.value==="")return h($.global.t("NoFile")),!1;if(!i.value&&m.value.length===0)return h($.global.t("NoFile")),!1;n.value++},R=async()=>{if(i.value&&(k.value=c.currentFolderPath),i.value&&k.value==="")return h($.global.t("NoFile")),!1;if(!i.value&&v.value.length===0)return h($.global.t("NoFile")),!1;let a={version:y.value,bg_folder_path:k.value,folder_path:b.value};const e=Y();try{await C.upload("/api/crop_xml_paste_to_background",m.value,v.value,a);const t=C.uploadResult;if(!t)return;if(t.code!==0){N(`API Error: ${t.code}`);return}S.value=t.result.all_names,n.value++,c.spaceSelected=[]}catch(t){N(`${t}`)}finally{e.close()}},X=(a,e)=>{console.log(a,e)},z=a=>{I.value=a.url,E.value=!0};return(a,e)=>(d(),f(oe,null,[p("h4",null,r(a.$t("CropLabels",{label:"xml"},1)),1),o(l(V)),p("div",ae,[p("div",se,[o(l(A),{active:n.value,"finish-status":"success",class:"w3-margin-bottom",direction:l(D).lt.md?"horizontal":"vertical"},{default:s(()=>[o(l(U),{title:a.$t("UploadLabel"),icon:l(B),onClick:e[0]||(e[0]=t=>(n.value=1,m.value=[],v.value=[])),class:"pointer"},null,8,["title","icon"]),o(l(U),{title:a.$t("UploadBG"),icon:l(B),onClick:e[1]||(e[1]=t=>(n.value=m.value.length>0?2:1,v.value=[])),class:"pointer"},null,8,["title","icon"]),o(l(U),{title:a.$t("Generate"),icon:l(J),onClick:e[2]||(e[2]=t=>n.value=S.value.length>0?3:2),class:"pointer"},null,8,["title","icon"])]),_:1},8,["active","direction"])]),o(l(W),null,{default:s(()=>[n.value===1?(d(),f("div",ie,[o(l(w),{type:"success",onClick:e[3]||(e[3]=t=>G())},{default:s(()=>[_(r(a.$t("Upload")),1)]),_:1}),o(l(V)),o(l(F),{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value=t)},{default:s(()=>[_(r(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(d(),f("div",re,[o(M,{"is-on-page":"","is-upload":""}),p("span",ue,r(a.$t("UploadImgXML")),1)])):(d(),T(l(L),{key:1,"file-list":m.value,"onUpdate:fileList":e[5]||(e[5]=t=>m.value=t),class:"upload-demo",action:"/api/crop_xml_paste_to_background","auto-upload":!1,multiple:"",drag:""},{tip:s(()=>[p("div",ne,r(a.$t("UploadImgXML")),1)]),default:s(()=>[o(l(P),{class:"el-icon--upload"},{default:s(()=>[o(l(K))]),_:1}),p("div",pe,[_(r(a.$t("DropFile"))+" ",1),p("em",null,r(a.$t("ClickToUpload")),1)])]),_:1},8,["file-list"]))])):g("",!0),n.value===2&&(m.value.length!==0||b.value!=="")?(d(),f("div",de,[o(l(w),{type:"success",onClick:e[6]||(e[6]=t=>R())},{default:s(()=>[_(r(a.$t("Upload")),1)]),_:1}),o(l(V)),o(l(F),{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value=t)},{default:s(()=>[_(r(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(d(),f("div",me,[o(M,{"is-on-page":"","is-upload":""}),p("span",ve,r(a.$t("UploadImg")),1)])):g("",!0),o(l(q),{label:a.$t("ResultDataVersion"),style:{width:"50%"}},{default:s(()=>[o(l(H),{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=t=>y.value=t)},null,8,["modelValue"])]),_:1},8,["label"]),i.value?g("",!0):(d(),T(l(L),{key:1,class:"upload-drag-img","file-list":v.value,"onUpdate:fileList":e[9]||(e[9]=t=>v.value=t),action:"/api/crop_xml_paste_to_background","list-type":"picture-card","auto-upload":!1,"on-preview":z,"on-remove":X,multiple:"",drag:""},{tip:s(()=>[p("div",fe,r(a.$t("UploadImg")),1)]),default:s(()=>[o(l(P),null,{default:s(()=>[o(l(O))]),_:1})]),_:1},8,["file-list"])),o(l(j),{modelValue:E.value,"onUpdate:modelValue":e[10]||(e[10]=t=>E.value=t)},{default:s(()=>[p("img",{style:{width:"100%"},src:I.value,alt:"Preview Image"},null,8,ce)]),_:1},8,["modelValue"])])):g("",!0),n.value===3&&S.value.length!==0?(d(),f("div",_e,[o(ee,{all_names:S.value},null,8,["all_names"])])):g("",!0)]),_:1})])],64))}});export{hl as default};

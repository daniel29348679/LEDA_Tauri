import"./base-23d00206.js";import{E as V,a as X}from"./el-steps-c8cdef54.js";import{E as h}from"./el-divider-67eeba91.js";import{a as F}from"./el-button-ded9ecc1.js";import{c as q}from"./el-main-e0dc383b.js";import{E as L}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as H}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as N}from"./el-form-item-62aac1b2.js";import{E as K}from"./el-input-51d05b2a.js";import{E as O}from"./el-input-number-815f9c07.js";import{E as j}from"./el-checkbox-d46297b7.js";import{d as B,o as Q,h as Y,p as Z}from"./@element-plus-a8abf029.js";import{u as x,w as k,i as C,o as ee,f as P}from"./index-d07dfee2.js";import{u as le}from"./uploadFileBG-e207f860.js";import{u as oe}from"./stashSpace-391fdb88.js";import{S as T}from"./StashSelect-5af938b3.js";import{R as te}from"./ResultImgWithStash-c075e0f0.js";import{E as D}from"./index-b8931eed.js";import{y as ae,h as se,b as r,i as ie,c as f,a as n,bf as u,ag as t,u as l,bI as s,S as re,o as d,af as c,a7 as J,a8 as _}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./event-9519ab40.js";import"./vnode-18f2a975.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./refs-e3a131a0.js";import"./async-validator-dee29e8b.js";import"./index-6127babd.js";import"./index-32075738.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import"./el-tooltip-4ed993c7.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-image-viewer-1a9f012d.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const ue={class:"step-page"},ne={class:"step-nav"},pe={key:0},de={key:0},me={class:"el-upload__tip"},ve={class:"el-upload__text"},fe={class:"el-upload__tip"},ce={key:1},_e={key:0,style:{"margin-bottom":"10px"}},ge={class:"el-upload__tip"},be={class:"el-upload__tip"},Se=["src"],Ee={key:2},hl=ae({__name:"CropJsonToJsonView",setup($e){const R=x(),g=oe();se(()=>{console.log("CropJsonToXML")});const p=r(1),E=r("v1"),$=r(1),m=r([]),v=r([]),I=le(),w=r(""),y=r(!1),b=r([]),i=r(!1),S=r(""),U=r(""),G=ie(()=>i.value?U.value!=="":v.value.length>0),M=()=>{if(i.value&&(S.value=g.currentFolderPath,g.spaceSelected=[]),i.value&&S.value==="")return k(C.global.t("NoFile")),!1;if(!i.value&&m.value.length===0)return k(C.global.t("NoFile")),!1;p.value++},z=async()=>{if(i.value&&(U.value=g.currentFolderPath),!G.value)return k(C.global.t("NoFile")),!1;let a={version:E.value,label_num:$.value,bg_folder_path:U.value,folder_path:S.value};const e=ee();try{await I.upload("/api/crop_json_paste_bg_json",m.value,v.value,a);const o=I.uploadResult;if(!o)return;if(o.code!==0){P(`API Error: ${o.code}`);return}b.value=o.result.all_names,p.value++,g.spaceSelected=[]}catch(o){P(`${o}`)}finally{e.close()}},A=(a,e)=>{console.log(a,e)},W=a=>{w.value=a.url,y.value=!0};return(a,e)=>(d(),f(re,null,[n("h4",null,u(a.$t("CropLabels",{label:"json",glabel:"json"},2)),1),t(l(h)),n("div",ue,[n("div",ne,[t(l(X),{active:p.value,"finish-status":"success",class:"w3-margin-bottom",direction:l(R).lt.md?"horizontal":"vertical"},{default:s(()=>[t(l(V),{title:a.$t("UploadLabel"),icon:l(B),onClick:e[0]||(e[0]=o=>(p.value=1,m.value=[],v.value=[])),class:"pointer"},null,8,["title","icon"]),t(l(V),{title:a.$t("UploadBG"),icon:l(B),onClick:e[1]||(e[1]=o=>(p.value=m.value.length>0?2:1,v.value=[])),class:"pointer"},null,8,["title","icon"]),t(l(V),{title:a.$t("Generate"),icon:l(Q),onClick:e[2]||(e[2]=o=>p.value=b.value.length>0?3:2),class:"pointer"},null,8,["title","icon"])]),_:1},8,["active","direction"])]),t(l(q),null,{default:s(()=>[p.value===1?(d(),f("div",pe,[t(l(F),{type:"success",onClick:e[3]||(e[3]=o=>M())},{default:s(()=>[c(u(a.$t("Upload")),1)]),_:1}),t(l(h)),t(l(j),{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value=o)},{default:s(()=>[c(u(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(d(),f("div",de,[t(T,{"is-on-page":"","is-upload":""}),n("span",me,u(a.$t("UploadImgJson")),1)])):(d(),J(l(L),{key:1,"file-list":m.value,"onUpdate:fileList":e[5]||(e[5]=o=>m.value=o),class:"upload-demo",action:"/api/crop_json_paste_bg_json","auto-upload":!1,multiple:"",drag:""},{tip:s(()=>[n("div",fe,u(a.$t("UploadImgJson")),1)]),default:s(()=>[t(l(D),{class:"el-icon--upload"},{default:s(()=>[t(l(Y))]),_:1}),n("div",ve,[c(u(a.$t("DropFile"))+" ",1),n("em",null,u(a.$t("ClickToUpload")),1)])]),_:1},8,["file-list"]))])):_("",!0),p.value===2&&(m.value.length!==0||S.value!=="")?(d(),f("div",ce,[t(l(F),{type:"success",onClick:e[6]||(e[6]=o=>z())},{default:s(()=>[c(u(a.$t("Upload")),1)]),_:1}),t(l(h)),t(l(j),{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=o=>i.value=o)},{default:s(()=>[c(u(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(d(),f("div",_e,[t(T,{"is-on-page":"","is-upload":""}),n("span",ge,u(a.$t("UploadImg")),1)])):_("",!0),t(l(N),{label:a.$t("ResultDataVersion"),style:{width:"50%"}},{default:s(()=>[t(l(K),{modelValue:E.value,"onUpdate:modelValue":e[8]||(e[8]=o=>E.value=o)},null,8,["modelValue"])]),_:1},8,["label"]),t(l(N),{label:a.$t("LabelNum"),style:{width:"50%"}},{default:s(()=>[t(l(O),{modelValue:$.value,"onUpdate:modelValue":e[9]||(e[9]=o=>$.value=o),min:1},null,8,["modelValue"])]),_:1},8,["label"]),i.value?_("",!0):(d(),J(l(L),{key:1,class:"upload-drag-img","file-list":v.value,"onUpdate:fileList":e[10]||(e[10]=o=>v.value=o),action:"/api/crop_json_paste_bg_json","list-type":"picture-card","auto-upload":!1,"on-preview":W,"on-remove":A,multiple:"",drag:""},{tip:s(()=>[n("div",be,u(a.$t("UploadImg")),1)]),default:s(()=>[t(l(D),null,{default:s(()=>[t(l(Z))]),_:1})]),_:1},8,["file-list"])),t(l(H),{modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=o=>y.value=o)},{default:s(()=>[n("img",{style:{width:"100%"},src:w.value,alt:"Preview Image"},null,8,Se)]),_:1},8,["modelValue"])])):_("",!0),p.value===3&&b.value.length!==0?(d(),f("div",Ee,[t(te,{all_names:b.value},null,8,["all_names"])])):_("",!0)]),_:1})])],64))}});export{hl as default};

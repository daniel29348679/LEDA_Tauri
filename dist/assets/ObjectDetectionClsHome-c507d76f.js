import"./base-23d00206.js";import{E,a as x}from"./el-row-67417f48.js";import{E as j}from"./el-card-a6aa41d5.js";import{E as D}from"./el-image-viewer-1a9f012d.js";import{E as I,a as A}from"./el-skeleton-item-b52dbad9.js";import{f as b,w as B}from"./index-d07dfee2.js";import{u as H}from"./app_od_cls-2bd090eb.js";import{Q as d}from"./QuartCard-b656d875.js";import{L as N}from"./vue-chartjs-22160128.js";import{C as T,p as U,a as V,b as $,P as F,c as P,d as Q,e as K}from"./chart.js-1176e628.js";import{y as M,b as u,h as Z,F as q,c as z,ag as e,bI as l,u as o,S as G,o as J,a as W}from"./@vue-19632928.js";import{_ as X}from"./json-editor-vue3-5344cb8d.js";import"./lodash-es-cc4652a2.js";import"./typescript-defaf979.js";import"./index-b8931eed.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";import"./@kurkle-36ca2f10.js";import"./jsoneditor-5f1e2c9e.js";const m=30,Y=M({__name:"ObjectDetectionClsHome",setup(ee){T.register(U,V,$,F,P,Q,K);const f=["rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(201, 203, 207)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(54, 162, 235)","rgb(255, 99, 132)"];let g=!1,i=[],r=[],s=[];const a=H(),p=u(""),v=u(0),_=u(0),h=u({labels:[],datasets:[]}),S=u({responsive:!0,animation:{duration:t=>t.dataIndex===m-1?600:0},animations:{},scales:{y:{beginAtZero:!0,stacked:!0}},interaction:{intersect:!1,mode:"index"}}),R=()=>{console.log("od result => ",s),console.log("objects => ",i),console.log("timeline => ",r);const t=r.map(c=>c.toLocaleTimeString()),n=i.map((c,w)=>({label:c,fill:!0,backgroundColor:f[w%f.length],borderColor:f[w%f.length],data:r.map((te,y)=>{const k=s[y].findIndex(O=>O.label===c);return~k?s[y][k].number:0})}));return{labels:t,datasets:n}},L=async()=>{try{let t=await a.checkInfo();if(t!==0){b(`check od cls poc info fail : ${t}`);return}if(a.info.load||B("請先至後台設定物件辨識分類應用"),a.info.doing){if(p.value=a.imgURL,t=await a.getInferResult(),t!==0){b(`get live inference result fail: ${t}`);return}if(a.inferResult){s.push(a.inferResult),s.length>m&&(s=s.slice(1,m+1)),i.push(...a.inferResult.map(n=>n.label)),i=i.filter((n,c)=>i.indexOf(n)===c),r.push(new Date),r.length>m&&(r=r.slice(1,m+1)),v.value=i.length,_.value=0;for(const n of a.inferResult)_.value+=n.number;h.value=R()}}}catch(t){b(`get live inference result fail: ${t}`)}},C=async()=>{g&&(await L(),setTimeout(()=>C(),1e3))};return Z(async()=>{console.log("物件辨識分類應用 mounted"),g=!0,await C()}),q(async()=>{console.log("物件辨識分類應用 unmounted"),g=!1}),(t,n)=>(J(),z(G,null,[e(o(E),{gutter:16,class:"w3-margin-top"},{default:l(()=>[e(d,{title:"Counting Numbers",value:_.value,diff:"2%",color:"red",info:"since last week",icon:""},null,8,["value"]),e(d,{title:"Specification",value:v.value,diff:"0.75%",color:"green",info:"since yesterday",icon:""},null,8,["value"]),e(d,{title:"Cameras Online",value:"1",diff:"OK",color:"green",info:"All systems are",suffix:""}),e(d,{title:"Vilolations",value:"8",diff:"2%",color:"red",info:"since last week",icon:""})]),_:1}),e(o(E),{gutter:16,class:"w3-margin-top"},{default:l(()=>[e(o(x),{span:10},{default:l(()=>[e(o(j),null,{default:l(()=>[n[0]||(n[0]=W("b",null,"Timeline Statistics",-1)),e(o(I),{rows:4,style:{height:"100%"},loading:!o(a).info.doing,throttle:500,animated:""},{default:l(()=>[e(o(N),{data:h.value,options:S.value},null,8,["data","options"])]),_:1},8,["loading"])]),_:1})]),_:1}),e(o(x),{span:14},{default:l(()=>[e(o(I),{style:{height:"100%"},loading:!o(a).info.doing||p.value==="",throttle:500,animated:""},{template:l(()=>[e(o(A),{variant:"image",style:{height:"100%"}})]),default:l(()=>[e(o(D),{src:p.value,"preview-src-list":[p.value]},null,8,["src","preview-src-list"])]),_:1},8,["loading"])]),_:1})]),_:1})],64))}});const Ae=X(Y,[["__scopeId","data-v-9f518849"]]);export{Ae as default};

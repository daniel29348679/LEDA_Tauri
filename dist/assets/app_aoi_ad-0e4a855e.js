import{d as L}from"./pinia-71cafef5.js";import{b as i}from"./earthApi-baaacd65.js";import{e as b}from"./index-d07dfee2.js";import{b as d}from"./@vue-19632928.js";const c="aoi-ad",m="ts_aoi_ad",N=L("app-aoi-ad",()=>{const l=d({load:!1}),p=d(""),_=d(),v=d(0),I=async a=>{var g,A;const{model_name:e,crop_m:t,crop_n:o,w_h_a:f,alert_area:n,name:r,draw_alert_area:w,isFinal:h,device:y,draw_box:R,score_type:S}=a,s=await i.api.initAdApiInitAdPost({model_name:e,crop_m:t,crop_n:o,w_h_a:f,alert_area:n,name:r??c,draw_alert_area:w,device:y,draw_box:R,score_type:S});return s==null||s.data.code==null?-1:s.data.code!==0?s.data.code:(v.value=((A=(g=s.data)==null?void 0:g.result)==null?void 0:A.threshold)??0,h?await u(r??c):0)},u=async a=>{const e=a??c,t=await i.api.infoAdApiInfoAdGet({name:e});if(console.log("res =>",t),t===void 0||t.data.code===void 0)return-1;if(t.data.code!==0)return t.data.code;if(l.value=t.data.result,t.data.result.doing&&t.data.result.result_image){let o=localStorage.getItem(m)??"";o===""&&(o=`${Date.now()}`,localStorage.setItem(m,o)),p.value=t.data.result.result_image+`&t=${o}`}return 0};return{info:l,init:I,checkInfo:u,startInfer:async(a,e,t,o=!0,f="map_score")=>{const n=t||c,r=await i.api.startLiveInferAdApiStartLiveInferAdPost({name:n,cam_name:a,threshold:e,draw_box:o,score_type:f});return console.log("res =>",r),r===void 0||r.data.code===void 0?-1:r.data.code!==0?r.data.code:await u(n)},stopInfer:async a=>{const e=await b("json","/api/stop_live_infer_ad",{name:a});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(localStorage.removeItem(m),l.value.doing=!1,0)},imgURL:p,getInferResult:async a=>{const e=await i.api.inferAdLiveResultApiInferAdLiveResultGet({name:a});return console.log("res =>",e),e===void 0||e.data.code===void 0?-1:e.data.code!==0?e.data.code:(_.value=e.data.result.last_result,0)},inferResult:_,threshold:v}});export{c as _,N as u};

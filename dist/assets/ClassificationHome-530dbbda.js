import"./base-23d00206.js";import{E as y,a as E}from"./el-row-67417f48.js";import{E as L}from"./el-card-a6aa41d5.js";import{E as D}from"./el-image-viewer-1a9f012d.js";import{E as k,a as O}from"./el-skeleton-item-b52dbad9.js";import{f as _,w as j}from"./index-d07dfee2.js";import{u as A}from"./app_cls-64073d85.js";import{Q as d}from"./QuartCard-b656d875.js";import{L as B}from"./vue-chartjs-22160128.js";import{C as H,p as T,a as U,b as V,P as $,c as F,d as N,e as P}from"./chart.js-1176e628.js";import{y as Q,b as f,h as K,F as M,c as Z,ag as e,bI as i,u as o,S as q,o as z,a as G}from"./@vue-19632928.js";import{_ as J}from"./json-editor-vue3-5344cb8d.js";import"./lodash-es-cc4652a2.js";import"./typescript-defaf979.js";import"./index-b8931eed.js";import"./@vueuse-0d360189.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";import"./@kurkle-36ca2f10.js";import"./jsoneditor-5f1e2c9e.js";const u=30,W=Q({__name:"ClassificationHome",setup(X){H.register(T,U,V,$,F,N,P);const m=["rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(201, 203, 207)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(54, 162, 235)","rgb(255, 99, 132)"];let g=!1,l=[],n=[],r=[];const a=A(),p=f(""),v=f(0),h=f(""),b=f({labels:[],datasets:[]}),x=f({responsive:!0,animation:{duration:t=>t.dataIndex===u-1?600:0},animations:{},scales:{y:{beginAtZero:!0}},interaction:{intersect:!1,mode:"index"}}),R=()=>{console.log("od result => ",r),console.log("objects => ",l),console.log("timeline => ",n);const t=n.map(c=>c.toLocaleTimeString()),s=l.map((c,w)=>({label:c,fill:!0,backgroundColor:m[w%m.length],borderColor:m[w%m.length],data:n.map((Y,I)=>r[I]===c?1:0)}));return{labels:t,datasets:s}},S=async()=>{try{let t=await a.checkInfo();if(t!==0){_(`check od poc info fail : ${t}`);return}if(a.info.load||j("請先至後台設定物件辨識應用"),a.info.doing){if(p.value=a.imgURL,t=await a.getInferResult(),t!==0){_(`get live inference result fail: ${t}`);return}a.inferResult&&(r.push(a.inferResult),r.length>u&&(r=r.slice(1,u+1)),l.push(a.inferResult),l=l.filter((s,c)=>l.indexOf(s)===c),n.push(new Date),n.length>u&&(n=n.slice(1,u+1)),v.value=l.length,h.value=a.inferResult,b.value=R())}}catch(t){_(`get live inference result fail: ${t}`)}},C=async()=>{g&&(await S(),setTimeout(()=>C(),1e3))};return K(async()=>{console.log("物件辨識應用 mounted"),g=!0,await C()}),M(async()=>{console.log("物件辨識應用 unmounted"),g=!1}),(t,s)=>(z(),Z(q,null,[e(o(y),{gutter:16,class:"w3-margin-top"},{default:i(()=>[e(d,{title:"Result",value:h.value,diff:"2%",color:"red",info:"since last week",icon:""},null,8,["value"]),e(d,{title:"Specification",value:v.value,diff:"0.75%",color:"green",info:"since yesterday",icon:""},null,8,["value"]),e(d,{title:"Cameras Online",value:"1",diff:"OK",color:"green",info:"All systems are",suffix:""}),e(d,{title:"Vilolations",value:"8",diff:"2%",color:"red",info:"since last week",icon:""})]),_:1}),e(o(y),{gutter:16,class:"w3-margin-top"},{default:i(()=>[e(o(E),{span:10},{default:i(()=>[e(o(L),null,{default:i(()=>[s[0]||(s[0]=G("b",null,"Timeline Statistics",-1)),e(o(k),{rows:4,style:{height:"100%"},loading:!o(a).info.doing,throttle:500,animated:""},{default:i(()=>[e(o(B),{data:b.value,options:x.value},null,8,["data","options"])]),_:1},8,["loading"])]),_:1})]),_:1}),e(o(E),{span:14},{default:i(()=>[e(o(k),{style:{height:"100%"},loading:!o(a).info.doing||p.value==="",throttle:500,animated:""},{template:i(()=>[e(o(O),{variant:"image",style:{height:"100%"}})]),default:i(()=>[e(o(D),{src:p.value,"preview-src-list":[p.value]},null,8,["src","preview-src-list"])]),_:1},8,["loading"])]),_:1})]),_:1})],64))}});const Oe=J(W,[["__scopeId","data-v-43ff105a"]]);export{Oe as default};

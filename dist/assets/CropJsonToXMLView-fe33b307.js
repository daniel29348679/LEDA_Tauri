import"./base-23d00206.js";import{E as k,a as A}from"./el-steps-c8cdef54.js";import{E as C}from"./el-divider-67eeba91.js";import{a as F}from"./el-button-ded9ecc1.js";import{c as W}from"./el-main-e0dc383b.js";import{E as L}from"./el-upload-5677c5b6.js";import"./el-progress-ed4e49af.js";import{E as q}from"./el-dialog-f482d18c.js";import"./el-overlay-81162264.js";import{E as N}from"./el-form-item-62aac1b2.js";import{E as H}from"./el-input-51d05b2a.js";import{E as K}from"./el-input-number-815f9c07.js";import{E as B}from"./el-checkbox-d46297b7.js";import{d as P,o as O,h as Q,p as Y}from"./@element-plus-a8abf029.js";import{u as Z,w as E,i as $,o as x,f as T}from"./index-d07dfee2.js";import{u as ee}from"./uploadFileBG-e207f860.js";import{u as le}from"./stashSpace-391fdb88.js";import{S as D}from"./StashSelect-5af938b3.js";import{R as oe}from"./ResultImgWithStash-c075e0f0.js";import{E as R}from"./index-b8931eed.js";import{y as te,h as ae,b as r,c as f,a as n,bf as u,ag as t,u as l,bI as s,S as se,o as m,af as g,a7 as j,a8 as _}from"./@vue-19632928.js";import"./lodash-es-cc4652a2.js";import"./event-9519ab40.js";import"./vnode-18f2a975.js";import"./index-711061c4.js";import"./@vueuse-0d360189.js";import"./@ctrl-f8748455.js";import"./error-78e43d3e.js";import"./typescript-defaf979.js";import"./earthApi-baaacd65.js";import"./axios-439bb627.js";import"./use-dialog-b8544ca4.js";import"./refs-e3a131a0.js";import"./async-validator-dee29e8b.js";import"./index-6127babd.js";import"./index-32075738.js";import"./quasar-ff3737c6.js";import"./pinia-71cafef5.js";import"./vue-konva-50f8b9a5.js";import"./konva-364a8bb7.js";import"./@logicflow-db5a80c3.js";import"./vue-router-841924de.js";import"./vue-i18n-76143ed6.js";import"./@intlify-0ef9a929.js";import"./tiff.js-f0b72392.js";import"./jszip-0fc1db0a.js";import"./@quasar-a9c09e53.js";/* empty css               */import"./el-select-99a9cb58.js";import"./el-scrollbar-e3b486eb.js";import"./el-tooltip-4ed993c7.js";import"./validator-7d68535e.js";import"./json-editor-vue3-5344cb8d.js";import"./jsoneditor-5f1e2c9e.js";import"./el-image-viewer-1a9f012d.js";import"./el-alert-65b82b76.js";import"./el-card-a6aa41d5.js";const ie={class:"step-page"},re={class:"step-nav"},ue={key:0},ne={key:0},pe={class:"el-upload__tip"},me={class:"el-upload__text"},de={class:"el-upload__tip"},ve={key:1},fe={key:0,style:{"margin-bottom":"10px"}},ce={class:"el-upload__tip"},ge={class:"el-upload__tip"},_e=["src"],be={key:2},Vl=te({__name:"CropJsonToXMLView",setup(Se){const J=Z(),c=le();ae(()=>{console.log("CropJsonToXML"),c.spaceSelected=[]});const p=r(1),y=r("v1"),V=r(1),d=r([]),v=r([]),I=ee(),w=r(""),h=r(!1),b=r([]),i=r(!1),S=r(""),U=r(""),M=()=>{if(i.value&&(S.value=c.currentFolderPath,c.spaceSelected=[]),i.value&&S.value==="")return E($.global.t("NoFile")),!1;if(!i.value&&d.value.length===0)return E($.global.t("NoFile")),!1;p.value++},G=async()=>{if(i.value&&(U.value=c.currentFolderPath),i.value&&U.value==="")return E($.global.t("NoFile")),!1;if(!i.value&&v.value.length===0)return E($.global.t("NoFile")),!1;let a={version:y.value,label_num:V.value,bg_folder_path:U.value,folder_path:S.value};const e=x();try{await I.upload("/api/crop_json_paste_bg_xml",d.value,v.value,a);const o=I.uploadResult;if(!o)return;if(o.code!==0){T(`API Error: ${o.code}`);return}b.value=o.result.all_names,p.value++,c.spaceSelected=[]}catch(o){T(`${o}`)}finally{e.close()}},X=(a,e)=>{console.log(a,e)},z=a=>{w.value=a.url,h.value=!0};return(a,e)=>(m(),f(se,null,[n("h4",null,u(a.$t("CropLabels",{label:"json",glabel:"xml"},2)),1),t(l(C)),n("div",ie,[n("div",re,[t(l(A),{active:p.value,"finish-status":"success",class:"w3-margin-bottom",direction:l(J).lt.md?"horizontal":"vertical"},{default:s(()=>[t(l(k),{title:a.$t("UploadLabel"),icon:l(P),onClick:e[0]||(e[0]=o=>(p.value=1,d.value=[],v.value=[])),class:"pointer"},null,8,["title","icon"]),t(l(k),{title:a.$t("UploadBG"),icon:l(P),onClick:e[1]||(e[1]=o=>(p.value=d.value.length>0?2:1,v.value=[])),class:"pointer"},null,8,["title","icon"]),t(l(k),{title:a.$t("Generate"),icon:l(O),onClick:e[2]||(e[2]=o=>p.value=b.value.length>0?3:2),class:"pointer"},null,8,["title","icon"])]),_:1},8,["active","direction"])]),t(l(W),null,{default:s(()=>[p.value===1?(m(),f("div",ue,[t(l(F),{type:"success",onClick:e[3]||(e[3]=o=>M())},{default:s(()=>[g(u(a.$t("Upload")),1)]),_:1}),t(l(C)),t(l(B),{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value=o)},{default:s(()=>[g(u(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(m(),f("div",ne,[t(D,{"is-on-page":"","is-upload":""}),n("span",pe,u(a.$t("UploadImgJson")),1)])):(m(),j(l(L),{key:1,"file-list":d.value,"onUpdate:fileList":e[5]||(e[5]=o=>d.value=o),class:"upload-demo",action:"/api/crop_json_paste_bg_xml","auto-upload":!1,multiple:"",drag:""},{tip:s(()=>[n("div",de,u(a.$t("UploadImgJson")),1)]),default:s(()=>[t(l(R),{class:"el-icon--upload"},{default:s(()=>[t(l(Q))]),_:1}),n("div",me,[g(u(a.$t("DropFile"))+" ",1),n("em",null,u(a.$t("ClickToUpload")),1)])]),_:1},8,["file-list"]))])):_("",!0),p.value===2&&(d.value.length!==0||S.value!=="")?(m(),f("div",ve,[t(l(F),{type:"success",onClick:e[6]||(e[6]=o=>G())},{default:s(()=>[g(u(a.$t("Upload")),1)]),_:1}),t(l(C)),t(l(B),{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=o=>i.value=o)},{default:s(()=>[g(u(a.$t("Label.UsingTemporaryStorageSpace")),1)]),_:1},8,["modelValue"]),i.value?(m(),f("div",fe,[t(D,{"is-on-page":"","is-upload":""}),n("span",ce,u(a.$t("UploadImg")),1)])):_("",!0),t(l(N),{label:a.$t("ResultDataVersion"),style:{width:"50%"}},{default:s(()=>[t(l(H),{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=o=>y.value=o)},null,8,["modelValue"])]),_:1},8,["label"]),t(l(N),{label:a.$t("LabelNum"),style:{width:"50%"}},{default:s(()=>[t(l(K),{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=o=>V.value=o),min:1},null,8,["modelValue"])]),_:1},8,["label"]),i.value?_("",!0):(m(),j(l(L),{key:1,class:"upload-drag-img","file-list":v.value,"onUpdate:fileList":e[10]||(e[10]=o=>v.value=o),action:"/api/crop_json_paste_bg_xml","list-type":"picture-card","auto-upload":!1,"on-preview":z,"on-remove":X,multiple:"",drag:""},{tip:s(()=>[n("div",ge,u(a.$t("UploadImg")),1)]),default:s(()=>[t(l(R),null,{default:s(()=>[t(l(Y))]),_:1})]),_:1},8,["file-list"])),t(l(q),{modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]=o=>h.value=o)},{default:s(()=>[n("img",{style:{width:"100%"},src:w.value,alt:"Preview Image"},null,8,_e)]),_:1},8,["modelValue"])])):_("",!0),p.value===3&&b.value.length!==0?(m(),f("div",be,[t(oe,{all_names:b.value},null,8,["all_names"])])):_("",!0)]),_:1})])],64))}});export{Vl as default};
